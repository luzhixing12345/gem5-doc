<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        Document
    </title>
    <link rel='stylesheet' href=../../../css/index.css />
    <link rel='stylesheet' href=../../../css/c.css /><link rel='stylesheet' href=../../../css/json.css /><link rel='stylesheet' href=../../../css/python.css /><link rel='stylesheet' href=../../../css/shell.css /><link rel='stylesheet' href=../../../css/txt.css />
    <link rel="icon" href="https://raw.githubusercontent.com/learner-lu/picbed/master/logo.png">
</head>

<body class="light">
    <a href="https://github.com/luzhixing12345/gem5-doc.git" target="_blank" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    <div class="header-navigator"><ul><li><a href="#h1-0">性能测试与统计结果</a><ul><li><a href="#h2-1">gem5 的统计模块</a></li></ul><ul><li><a href="#h2-2">Stream</a></li></ul><ul><li><a href="#h2-3">Redis</a></li></ul><ul><li><a href="#h2-4">驱动测试</a></li></ul><ul><li><a href="#h2-5">memkind/vmem分配CXL设备内存的测试</a></li></ul><ul><li><a href="#h2-6">参考</a></li></ul></li></ul></div><div class='markdown-body'><h1 id="h1-0">性能测试与统计结果</h1><h2 id="h2-1">gem5 的统计模块</h2><p>gem5 自带了统计模块并提供了使用的头文件, 位于 <code>include/m5opt.h</code> 中, 在使用之前我们需要先编译一下对应的静态链接库. 这个库位于 <code>util/m5</code> 下, 你可以在 README.md 中找到更多信息</p><p>对于 x86 下的编译, 我们直接使用如下命令编译(需要先进入 util/m5 目录下执行)</p><pre class="language-shell"><code><span class="Token Keyword CD">cd</span><span class="Token SPACE"> </span><span class="Token PATH">util/m5</span><span class="Token LF">
</span><span class="Token Program ID">scons</span><span class="Token SPACE"> </span><span class="Token PATH">build/x86/out/m5</span></code></pre><blockquote><p>注意这里的是小写的 x86</p></blockquote><p>编译结束之后将 <code>build/x86/out/libm5.a</code> 静态库复制出来, 然后稍微调整一下文件的相对关系</p><p>调整后 include/ 下目录结构应如下所示, 其中 m5test 是我们实验的目标文件夹</p><pre class="language-shell"><code><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">benchmark</span><span class="Token LF">
</span><span class="Token TEXT">│</span><span class="Token TEXT"> </span><span class="Token TEXT"> </span><span class="Token SPACE"> </span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">m5test</span><span class="Token LF">
</span><span class="Token TEXT">│</span><span class="Token TEXT"> </span><span class="Token TEXT"> </span><span class="Token SPACE"> </span><span class="Token TEXT">│</span><span class="Token TEXT"> </span><span class="Token TEXT"> </span><span class="Token SPACE"> </span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">asm</span><span class="Token LF">
</span><span class="Token TEXT">│</span><span class="Token TEXT"> </span><span class="Token TEXT"> </span><span class="Token SPACE"> </span><span class="Token TEXT">│</span><span class="Token TEXT"> </span><span class="Token TEXT"> </span><span class="Token SPACE"> </span><span class="Token TEXT">│</span><span class="Token TEXT"> </span><span class="Token TEXT"> </span><span class="Token SPACE"> </span><span class="Token TEXT">└</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">m5ops.h</span><span class="Token LF">
</span><span class="Token TEXT">│</span><span class="Token TEXT"> </span><span class="Token TEXT"> </span><span class="Token SPACE"> </span><span class="Token TEXT">│</span><span class="Token TEXT"> </span><span class="Token TEXT"> </span><span class="Token SPACE"> </span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">libm5.a</span><span class="Token LF">
</span><span class="Token TEXT">│</span><span class="Token TEXT"> </span><span class="Token TEXT"> </span><span class="Token SPACE"> </span><span class="Token TEXT">│</span><span class="Token TEXT"> </span><span class="Token TEXT"> </span><span class="Token SPACE"> </span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">m5ops.h</span><span class="Token LF">
</span><span class="Token TEXT">│</span><span class="Token TEXT"> </span><span class="Token TEXT"> </span><span class="Token SPACE"> </span><span class="Token TEXT">│</span><span class="Token TEXT"> </span><span class="Token TEXT"> </span><span class="Token SPACE"> </span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">m5_statistic.cpp</span><span class="Token LF">
</span><span class="Token TEXT">│</span><span class="Token TEXT"> </span><span class="Token TEXT"> </span><span class="Token SPACE"> </span><span class="Token TEXT">│</span><span class="Token TEXT"> </span><span class="Token TEXT"> </span><span class="Token SPACE"> </span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">Makefile</span><span class="Token LF">
</span><span class="Token TEXT">│</span><span class="Token TEXT"> </span><span class="Token TEXT"> </span><span class="Token SPACE"> </span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">Makefile</span><span class="Token LF">
</span><span class="Token TEXT">└</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">gem5</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">asm</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token TEXT">│</span><span class="Token TEXT"> </span><span class="Token TEXT"> </span><span class="Token SPACE"> </span><span class="Token TEXT">└</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">generic</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token TEXT">│</span><span class="Token TEXT"> </span><span class="Token TEXT"> </span><span class="Token SPACE">     </span><span class="Token TEXT">└</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">m5ops.h</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">libm5.a</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token TEXT">└</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">m5ops.h</span></code></pre><blockquote><p>注意原 include/gem5 下有两个 m5ops.h, 都并不复杂, 只是将他们移动到另一个文件夹,并修改一下头文件的引用关系即可, 然后将 libm5.a 移动到 m5test 下, m5_statistic.cpp 是我们的测试文件</p></blockquote><p><code>m5_statistic.cpp</code> 测试代码如下所示, 简单的内存访问测试和加法运算, m5_reset_stats 和 m5_dump_stats 则分别用于开始和保存记录,详见 <a href="https://www.gem5.org/documentation/general_docs/m5ops/" target="_blank">The m5 Utility(fs mode)</a></p><pre class="language-cpp"><code>#include &lt;iostream&gt;
#include &lt;vector&gt;
#include &quot;m5ops.h&quot;

int main() {
    m5_reset_stats(0, 0);
    std::cout &lt;&lt; &quot;start program\n&quot;;
    std::vector&lt;int&gt; sum(100,0);
    for (int i=0;i&lt;100;i++) {
        sum[i] = i;
    }
    int sum_result = 0;
    for (int i=0;i&lt;100;i++) {
        sum_result += sum[i];
    }
    m5_dump_stats(0, 0);
    std::cout &lt;&lt; sum_result &lt;&lt; std::endl;
    return 0;
}</code></pre><p>对应的编译指令如下, 你可以使用 make 来执行</p><pre class="language-shell"><code><span class="Token Program ID">g++</span><span class="Token SPACE"> </span><span class="Token OPTION">-L</span><span class="Token PATH">./</span><span class="Token SPACE"> </span><span class="Token ID">m5_statistic.cpp</span><span class="Token SPACE"> </span><span class="Token OPTION">-lm5</span><span class="Token SPACE"> </span><span class="Token OPTION">-o</span><span class="Token SPACE"> </span><span class="Token ID">a</span></code></pre><p>这样我们可以得到可执行文件 <code>a</code>, 但请注意 <b>这个程序并不能直接执行</b>, 因为 libm5.a 需要依赖 gem5 的运行时库, 在本机中是无法执行此文件的, 会出现 <code>illegal instruction (core dumped)</code> 的报错</p><p><b>我们需要将磁盘挂载, 然后将文件夹复制进去编译, 在 fs 中执行才可以得到结果</b></p><ul><li><a href="https://www.gem5.org/documentation/learning_gem5/part1/gem5_stats/" target="_blank">Understanding gem5 statistics and output</a></li></ul><ul><li><a href="https://www.gem5.org/documentation/general_docs/m5ops/" target="_blank">gem5 M5ops</a></li></ul><ul><li><a href="https://www.gem5.org/documentation/general_docs/statistics/" target="_blank">gem5 Stats Package</a></li></ul><ul><li><a href="https://www.gem5.org/documentation/general_docs/statistics/api" target="_blank">gem5 Statistics APIs</a></li></ul><ul><li><a href="https://blog.csdn.net/qq_46675545/article/details/128278644" target="_blank">Gem5模拟器,详解官网教程的statistics and output(三)</a></li></ul><ul><li><a href="https://blog.csdn.net/qq_46675545/article/details/129357227" target="_blank">Gem5模拟器,如何在linux系统中查看内存、CPU、硬盘、进程、网络等信息(十二)</a></li></ul><hr><h2 id="h2-2">Stream</h2><p>Stream测试是内存测试中业界公认的内存带宽性能测试基准工具, 测试行为相对简单可控.该程序对CPU的计算能力要求很小,对CPU内存带宽压力很大.</p><p>随着处理器核心数量的增大,而内存带宽并没有随之成线性增长,因此内存带宽对提升多核心的处理能力就越发重要.Stream具有良好的空间局部性,是对TLB友好,Cache友好的一款测试程序,其分为Copy、Scale、Add和Triad四个基本的测试功能.这四个功能描述如下表</p><table><tr><th>测试功能</th><th>基本操作</th><th>操作</th></tr><tr><td style="text-align:center">                Copy</td><td style="text-align:center">                c[i]=a[i]</td><td style="text-align:center">                1R1W</td></tr><tr><td style="text-align:center">                Scale</td><td style="text-align:center">                b[i]=scalar*c[i]</td><td style="text-align:center">                1R1W</td></tr><tr><td style="text-align:center">                Add</td><td style="text-align:center">                c[i]=a[i]+b[i]</td><td style="text-align:center">                2R1W</td></tr><tr><td style="text-align:center">                Triad</td><td style="text-align:center">                a[i]=b[i]+scalar*c[i]</td><td style="text-align:center">                2R1W</td></tr></table><p>Stream 使用四个基本的的测试功能用于测试 读/写的内存带宽, 其使用方式很简单,源码只有一个 .c 文件, 可以直接通过 wget 下载</p><pre class="language-shell"><code><span class="Token Program ID">wget</span><span class="Token SPACE"> </span><span class="Token Url ID">http://www.cs.virginia.edu/stream/FTP/Code/stream.c</span></code></pre><p>编译</p><pre class="language-shell"><code><span class="Token Program ID">gcc</span><span class="Token SPACE"> </span><span class="Token OPTION">-O3</span><span class="Token SPACE"> </span><span class="Token OPTION">-fopenmp</span><span class="Token SPACE"> </span><span class="Token OPTION">-DN</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">2000000</span><span class="Token SPACE"> </span><span class="Token OPTION">-DNTIMES</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">10</span><span class="Token SPACE"> </span><span class="Token ID">stream.c</span><span class="Token SPACE"> </span><span class="Token OPTION">-o</span><span class="Token SPACE"> </span><span class="Token ID">stream</span></code></pre><pre class="language-shell"><code><span class="Token OPTION">-------------------------------------------------------------</span><span class="Token LF">
</span><span class="Token Program ID">STREAM</span><span class="Token SPACE"> </span><span class="Token ID">version</span><span class="Token SPACE"> </span><span class="Token VARIANT">$Revision</span><span class="Token COLON">:</span><span class="Token SPACE"> </span><span class="Token NUMBER">5.10</span><span class="Token SPACE"> </span><span class="Token VARIANT">$</span><span class="Token LF">
</span><span class="Token OPTION">-------------------------------------------------------------</span><span class="Token LF">
</span><span class="Token Program ID">This</span><span class="Token SPACE"> </span><span class="Token ID">system</span><span class="Token SPACE"> </span><span class="Token ID">uses</span><span class="Token SPACE"> </span><span class="Token NUMBER">8</span><span class="Token SPACE"> </span><span class="Token ID">bytes</span><span class="Token SPACE"> </span><span class="Token ID">per</span><span class="Token SPACE"> </span><span class="Token ID">array</span><span class="Token SPACE"> </span><span class="Token ID">element.</span><span class="Token LF">
</span><span class="Token OPTION">-------------------------------------------------------------</span><span class="Token LF">
</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token SPACE">  </span><span class="Token Program ID">WARNING:</span><span class="Token SPACE"> </span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token LF">
</span><span class="Token SPACE">      </span><span class="Token Program ID">It</span><span class="Token SPACE"> </span><span class="Token ID">appears</span><span class="Token SPACE"> </span><span class="Token ID">that</span><span class="Token SPACE"> </span><span class="Token ID">you</span><span class="Token SPACE"> </span><span class="Token ID">set</span><span class="Token SPACE"> </span><span class="Token ID">the</span><span class="Token SPACE"> </span><span class="Token ID">preprocessor</span><span class="Token SPACE"> </span><span class="Token ID">variable</span><span class="Token SPACE"> </span><span class="Token ID">N</span><span class="Token SPACE"> </span><span class="Token ID">when</span><span class="Token SPACE"> </span><span class="Token ID">compiling</span><span class="Token SPACE"> </span><span class="Token ID">this</span><span class="Token SPACE"> </span><span class="Token ID">code.</span><span class="Token LF">
</span><span class="Token SPACE">      </span><span class="Token Program ID">This</span><span class="Token SPACE"> </span><span class="Token ID">version</span><span class="Token SPACE"> </span><span class="Token ID">of</span><span class="Token SPACE"> </span><span class="Token ID">the</span><span class="Token SPACE"> </span><span class="Token ID">code</span><span class="Token SPACE"> </span><span class="Token ID">uses</span><span class="Token SPACE"> </span><span class="Token ID">the</span><span class="Token SPACE"> </span><span class="Token ID">preprocesor</span><span class="Token SPACE"> </span><span class="Token ID">variable</span><span class="Token SPACE"> </span><span class="Token ID">STREAM_ARRAY_SIZE</span><span class="Token SPACE"> </span><span class="Token ID">to</span><span class="Token SPACE"> </span><span class="Token ID">control</span><span class="Token SPACE"> </span><span class="Token ID">the</span><span class="Token SPACE"> </span><span class="Token ID">array</span><span class="Token SPACE"> </span><span class="Token ID">size</span><span class="Token LF">
</span><span class="Token SPACE">      </span><span class="Token Program ID">Reverting</span><span class="Token SPACE"> </span><span class="Token ID">to</span><span class="Token SPACE"> </span><span class="Token ID">default</span><span class="Token SPACE"> </span><span class="Token ID">value</span><span class="Token SPACE"> </span><span class="Token ID">of</span><span class="Token SPACE"> </span><span class="Token Variant ID">STREAM_ARRAY_SIZE</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">10000000</span><span class="Token LF">
</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token SPACE">  </span><span class="Token Program ID">WARNING:</span><span class="Token SPACE"> </span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token LF">
</span><span class="Token Program ID">Array</span><span class="Token SPACE"> </span><span class="Token Variant ID">size</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">10000000</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">elements</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Variant ID">Offset</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">0</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">elements</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token LF">
</span><span class="Token Program ID">Memory</span><span class="Token SPACE"> </span><span class="Token ID">per</span><span class="Token SPACE"> </span><span class="Token Variant ID">array</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">76.3</span><span class="Token SPACE"> </span><span class="Token Function ID">MiB</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">0.1</span><span class="Token SPACE"> </span><span class="Token ID">GiB</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token ID">.</span><span class="Token LF">
</span><span class="Token Program ID">Total</span><span class="Token SPACE"> </span><span class="Token ID">memory</span><span class="Token SPACE"> </span><span class="Token Variant ID">required</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">228.9</span><span class="Token SPACE"> </span><span class="Token Function ID">MiB</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">0.2</span><span class="Token SPACE"> </span><span class="Token ID">GiB</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token ID">.</span><span class="Token LF">
</span><span class="Token Program ID">Each</span><span class="Token SPACE"> </span><span class="Token ID">kernel</span><span class="Token SPACE"> </span><span class="Token ID">will</span><span class="Token SPACE"> </span><span class="Token ID">be</span><span class="Token SPACE"> </span><span class="Token ID">executed</span><span class="Token SPACE"> </span><span class="Token NUMBER">10</span><span class="Token SPACE"> </span><span class="Token ID">times.</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="Token Program ID">The</span><span class="Token SPACE"> </span><span class="Token MUL">*</span><span class="Token ID">best</span><span class="Token MUL">*</span><span class="Token SPACE"> </span><span class="Token ID">time</span><span class="Token SPACE"> </span><span class="Token Keyword FOR">for</span><span class="Token SPACE"> </span><span class="Token ID">each</span><span class="Token SPACE"> </span><span class="Token Function ID">kernel</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">excluding</span><span class="Token SPACE"> </span><span class="Token ID">the</span><span class="Token SPACE"> </span><span class="Token ID">first</span><span class="Token SPACE"> </span><span class="Token ID">iteration</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="Token Program ID">will</span><span class="Token SPACE"> </span><span class="Token ID">be</span><span class="Token SPACE"> </span><span class="Token ID">used</span><span class="Token SPACE"> </span><span class="Token ID">to</span><span class="Token SPACE"> </span><span class="Token ID">compute</span><span class="Token SPACE"> </span><span class="Token ID">the</span><span class="Token SPACE"> </span><span class="Token ID">reported</span><span class="Token SPACE"> </span><span class="Token ID">bandwidth.</span><span class="Token LF">
</span><span class="Token OPTION">-------------------------------------------------------------</span><span class="Token LF">
</span><span class="Token Program ID">Number</span><span class="Token SPACE"> </span><span class="Token ID">of</span><span class="Token SPACE"> </span><span class="Token ID">Threads</span><span class="Token SPACE"> </span><span class="Token Variant ID">requested</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">16</span><span class="Token LF">
</span><span class="Token Program ID">Number</span><span class="Token SPACE"> </span><span class="Token ID">of</span><span class="Token SPACE"> </span><span class="Token ID">Threads</span><span class="Token SPACE"> </span><span class="Token Variant ID">counted</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">16</span><span class="Token LF">
</span><span class="Token OPTION">-------------------------------------------------------------</span><span class="Token LF">
</span><span class="Token Program ID">Your</span><span class="Token SPACE"> </span><span class="Token ID">clock</span><span class="Token SPACE"> </span><span class="Token PATH">granularity/precision</span><span class="Token SPACE"> </span><span class="Token ID">appears</span><span class="Token SPACE"> </span><span class="Token ID">to</span><span class="Token SPACE"> </span><span class="Token ID">be</span><span class="Token SPACE"> </span><span class="Token NUMBER">1</span><span class="Token SPACE"> </span><span class="Token ID">microseconds.</span><span class="Token LF">
</span><span class="Token Program ID">Each</span><span class="Token SPACE"> </span><span class="Token ID">test</span><span class="Token SPACE"> </span><span class="Token ID">below</span><span class="Token SPACE"> </span><span class="Token ID">will</span><span class="Token SPACE"> </span><span class="Token ID">take</span><span class="Token SPACE"> </span><span class="Token ID">on</span><span class="Token SPACE"> </span><span class="Token ID">the</span><span class="Token SPACE"> </span><span class="Token ID">order</span><span class="Token SPACE"> </span><span class="Token ID">of</span><span class="Token SPACE"> </span><span class="Token NUMBER">24564</span><span class="Token SPACE"> </span><span class="Token ID">microseconds.</span><span class="Token LF">
</span><span class="Token SPACE">   </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">24564</span><span class="Token SPACE"> </span><span class="Token Program ID">clock</span><span class="Token SPACE"> </span><span class="Token ID">ticks</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token LF">
</span><span class="Token Program ID">Increase</span><span class="Token SPACE"> </span><span class="Token ID">the</span><span class="Token SPACE"> </span><span class="Token ID">size</span><span class="Token SPACE"> </span><span class="Token ID">of</span><span class="Token SPACE"> </span><span class="Token ID">the</span><span class="Token SPACE"> </span><span class="Token ID">arrays</span><span class="Token SPACE"> </span><span class="Token Keyword IF">if</span><span class="Token SPACE"> </span><span class="Token ID">this</span><span class="Token SPACE"> </span><span class="Token ID">shows</span><span class="Token SPACE"> </span><span class="Token ID">that</span><span class="Token LF">
</span><span class="Token Program ID">you</span><span class="Token SPACE"> </span><span class="Token ID">are</span><span class="Token SPACE"> </span><span class="Token ID">not</span><span class="Token SPACE"> </span><span class="Token ID">getting</span><span class="Token SPACE"> </span><span class="Token ID">at</span><span class="Token SPACE"> </span><span class="Token ID">least</span><span class="Token SPACE"> </span><span class="Token NUMBER">20</span><span class="Token SPACE"> </span><span class="Token ID">clock</span><span class="Token SPACE"> </span><span class="Token ID">ticks</span><span class="Token SPACE"> </span><span class="Token ID">per</span><span class="Token SPACE"> </span><span class="Token ID">test.</span><span class="Token LF">
</span><span class="Token OPTION">-------------------------------------------------------------</span><span class="Token LF">
</span><span class="Token Program ID">WARNING</span><span class="Token SPACE"> </span><span class="Token OPTION">--</span><span class="Token SPACE"> </span><span class="Token ID">The</span><span class="Token SPACE"> </span><span class="Token ID">above</span><span class="Token SPACE"> </span><span class="Token ID">is</span><span class="Token SPACE"> </span><span class="Token ID">only</span><span class="Token SPACE"> </span><span class="Token ID">a</span><span class="Token SPACE"> </span><span class="Token ID">rough</span><span class="Token SPACE"> </span><span class="Token ID">guideline.</span><span class="Token LF">
</span><span class="Token Program ID">For</span><span class="Token SPACE"> </span><span class="Token ID">best</span><span class="Token SPACE"> </span><span class="Token ID">results</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token ID">please</span><span class="Token SPACE"> </span><span class="Token ID">be</span><span class="Token SPACE"> </span><span class="Token ID">sure</span><span class="Token SPACE"> </span><span class="Token ID">you</span><span class="Token SPACE"> </span><span class="Token ID">know</span><span class="Token SPACE"> </span><span class="Token ID">the</span><span class="Token LF">
</span><span class="Token Program ID">precision</span><span class="Token SPACE"> </span><span class="Token ID">of</span><span class="Token SPACE"> </span><span class="Token ID">your</span><span class="Token SPACE"> </span><span class="Token ID">system</span><span class="Token SPACE"> </span><span class="Token ID">timer.</span><span class="Token LF">
</span><span class="Token OPTION">-------------------------------------------------------------</span><span class="Token LF">
</span><span class="Token Program ID">Function</span><span class="Token SPACE">    </span><span class="Token ID">Best</span><span class="Token SPACE"> </span><span class="Token ID">Rate</span><span class="Token SPACE"> </span><span class="Token PATH">MB/s</span><span class="Token SPACE">  </span><span class="Token ID">Avg</span><span class="Token SPACE"> </span><span class="Token ID">time</span><span class="Token SPACE">     </span><span class="Token ID">Min</span><span class="Token SPACE"> </span><span class="Token ID">time</span><span class="Token SPACE">     </span><span class="Token ID">Max</span><span class="Token SPACE"> </span><span class="Token ID">time</span><span class="Token LF">
</span><span class="Token Program ID">Copy:</span><span class="Token SPACE">           </span><span class="Token NUMBER">10877.0</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.034799</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.014710</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.042124</span><span class="Token LF">
</span><span class="Token Program ID">Scale:</span><span class="Token SPACE">           </span><span class="Token NUMBER">7399.2</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.046780</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.021624</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.069402</span><span class="Token LF">
</span><span class="Token Program ID">Add:</span><span class="Token SPACE">             </span><span class="Token NUMBER">8510.4</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.062834</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.028201</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.084992</span><span class="Token LF">
</span><span class="Token Program ID">Triad:</span><span class="Token SPACE">           </span><span class="Token NUMBER">6723.8</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.062384</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.035694</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.086763</span><span class="Token LF">
</span><span class="Token OPTION">-------------------------------------------------------------</span><span class="Token LF">
</span><span class="Token Program ID">Solution</span><span class="Token SPACE"> </span><span class="Token ID">Validates:</span><span class="Token SPACE"> </span><span class="Token ID">avg</span><span class="Token SPACE"> </span><span class="Token ID">error</span><span class="Token SPACE"> </span><span class="Token ID">less</span><span class="Token SPACE"> </span><span class="Token ID">than</span><span class="Token SPACE"> </span><span class="Token NUMBER">1.000000e-13</span><span class="Token SPACE"> </span><span class="Token ID">on</span><span class="Token SPACE"> </span><span class="Token ID">all</span><span class="Token SPACE"> </span><span class="Token ID">three</span><span class="Token SPACE"> </span><span class="Token ID">arrays</span><span class="Token LF">
</span><span class="Token OPTION">-------------------------------------------------------------</span></code></pre><p>本机 CPU 规格如下</p><pre class="language-shell"><code><span class="Token VARIANT">$</span><span class="Token SPACE"> </span><span class="Token Program ID">lscpu</span><span class="Token LF">
</span><span class="Token Program ID">Architecture:</span><span class="Token SPACE">            </span><span class="Token ID">x86_64</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Program ID">CPU</span><span class="Token SPACE"> </span><span class="Token Function ID">op-mode</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">s</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COLON">:</span><span class="Token SPACE">        </span><span class="Token NUMBER">32</span><span class="Token OPTION">-bit</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token NUMBER">64</span><span class="Token OPTION">-bit</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Program ID">Address</span><span class="Token SPACE"> </span><span class="Token ID">sizes:</span><span class="Token SPACE">         </span><span class="Token NUMBER">39</span><span class="Token SPACE"> </span><span class="Token ID">bits</span><span class="Token SPACE"> </span><span class="Token ID">physical</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token NUMBER">48</span><span class="Token SPACE"> </span><span class="Token ID">bits</span><span class="Token SPACE"> </span><span class="Token ID">virtual</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Program ID">Byte</span><span class="Token SPACE"> </span><span class="Token ID">Order:</span><span class="Token SPACE">            </span><span class="Token ID">Little</span><span class="Token SPACE"> </span><span class="Token ID">Endian</span><span class="Token LF">
</span><span class="Token Function Program ID">CPU</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">s</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COLON">:</span><span class="Token SPACE">                  </span><span class="Token NUMBER">16</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Program ID">On-line</span><span class="Token SPACE"> </span><span class="Token Function ID">CPU</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">s</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token ID">list:</span><span class="Token SPACE">   </span><span class="Token NUMBER">0</span><span class="Token MINUS">-</span><span class="Token NUMBER">15</span><span class="Token LF">
</span><span class="Token Program ID">Vendor</span><span class="Token SPACE"> </span><span class="Token ID">ID:</span><span class="Token SPACE">               </span><span class="Token ID">GenuineIntel</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Program ID">Model</span><span class="Token SPACE"> </span><span class="Token ID">name:</span><span class="Token SPACE">            </span><span class="Token NUMBER">11</span><span class="Token ID">th</span><span class="Token SPACE"> </span><span class="Token ID">Gen</span><span class="Token SPACE"> </span><span class="Token Function ID">Intel</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">R</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token Function ID">Core</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">TM</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token ID">i7-11800H</span><span class="Token SPACE"> </span><span class="Token AT_SIGN">@</span><span class="Token SPACE"> </span><span class="Token NUMBER">2.30G</span><span class="Token ID">Hz</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token Program ID">CPU</span><span class="Token SPACE"> </span><span class="Token ID">family:</span><span class="Token SPACE">          </span><span class="Token NUMBER">6</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token Program ID">Model:</span><span class="Token SPACE">               </span><span class="Token NUMBER">141</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token Function Program ID">Thread</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">s</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token ID">per</span><span class="Token SPACE"> </span><span class="Token ID">core:</span><span class="Token SPACE">  </span><span class="Token NUMBER">2</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token Function Program ID">Core</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">s</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token ID">per</span><span class="Token SPACE"> </span><span class="Token ID">socket:</span><span class="Token SPACE">  </span><span class="Token NUMBER">8</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token Function Program ID">Socket</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">s</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COLON">:</span><span class="Token SPACE">           </span><span class="Token NUMBER">1</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token Program ID">Stepping:</span><span class="Token SPACE">            </span><span class="Token NUMBER">1</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token Program ID">CPU</span><span class="Token SPACE"> </span><span class="Token ID">max</span><span class="Token SPACE"> </span><span class="Token ID">MHz:</span><span class="Token SPACE">         </span><span class="Token NUMBER">4600.0000</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token Program ID">CPU</span><span class="Token SPACE"> </span><span class="Token ID">min</span><span class="Token SPACE"> </span><span class="Token ID">MHz:</span><span class="Token SPACE">         </span><span class="Token NUMBER">800.0000</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token Program ID">BogoMIPS:</span><span class="Token SPACE">            </span><span class="Token NUMBER">4608.00</span><span class="Token LF">
</span><span class="Token Program ID">Virtualization</span><span class="Token SPACE"> </span><span class="Token ID">features:</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Program ID">Virtualization:</span><span class="Token SPACE">        </span><span class="Token ID">VT-x</span><span class="Token LF">
</span><span class="Token Function Program ID">Caches</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">sum</span><span class="Token SPACE"> </span><span class="Token ID">of</span><span class="Token SPACE"> </span><span class="Token ID">all</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COLON">:</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Program ID">L1d:</span><span class="Token SPACE">                   </span><span class="Token NUMBER">384</span><span class="Token SPACE"> </span><span class="Token Function ID">KiB</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token NUMBER">8</span><span class="Token SPACE"> </span><span class="Token ID">instances</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Program ID">L1i:</span><span class="Token SPACE">                   </span><span class="Token NUMBER">256</span><span class="Token SPACE"> </span><span class="Token Function ID">KiB</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token NUMBER">8</span><span class="Token SPACE"> </span><span class="Token ID">instances</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Program ID">L2:</span><span class="Token SPACE">                    </span><span class="Token NUMBER">10</span><span class="Token SPACE"> </span><span class="Token Function ID">MiB</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token NUMBER">8</span><span class="Token SPACE"> </span><span class="Token ID">instances</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Program ID">L3:</span><span class="Token SPACE">                    </span><span class="Token NUMBER">24</span><span class="Token SPACE"> </span><span class="Token Function ID">MiB</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token NUMBER">1</span><span class="Token SPACE"> </span><span class="Token ID">instance</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token LF">
</span></code></pre><p>gem5 fs 中</p><pre class="language-shell"><code><span class="Token OPTION">-------------------------------------------------------------</span><span class="Token LF">
</span><span class="Token Program ID">STREAM</span><span class="Token SPACE"> </span><span class="Token ID">version</span><span class="Token SPACE"> </span><span class="Token VARIANT">$Revision</span><span class="Token COLON">:</span><span class="Token SPACE"> </span><span class="Token NUMBER">5.10</span><span class="Token SPACE"> </span><span class="Token VARIANT">$</span><span class="Token LF">
</span><span class="Token OPTION">-------------------------------------------------------------</span><span class="Token LF">
</span><span class="Token Program ID">This</span><span class="Token SPACE"> </span><span class="Token ID">system</span><span class="Token SPACE"> </span><span class="Token ID">uses</span><span class="Token SPACE"> </span><span class="Token NUMBER">8</span><span class="Token SPACE"> </span><span class="Token ID">bytes</span><span class="Token SPACE"> </span><span class="Token ID">per</span><span class="Token SPACE"> </span><span class="Token ID">array</span><span class="Token SPACE"> </span><span class="Token ID">element.</span><span class="Token LF">
</span><span class="Token OPTION">-------------------------------------------------------------</span><span class="Token LF">
</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token SPACE">  </span><span class="Token Program ID">WARNING:</span><span class="Token SPACE"> </span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token LF">
</span><span class="Token SPACE">      </span><span class="Token Program ID">It</span><span class="Token SPACE"> </span><span class="Token ID">appears</span><span class="Token SPACE"> </span><span class="Token ID">that</span><span class="Token SPACE"> </span><span class="Token ID">you</span><span class="Token SPACE"> </span><span class="Token ID">set</span><span class="Token SPACE"> </span><span class="Token ID">the</span><span class="Token SPACE"> </span><span class="Token ID">preprocessor</span><span class="Token SPACE"> </span><span class="Token ID">variable</span><span class="Token SPACE"> </span><span class="Token ID">N</span><span class="Token SPACE"> </span><span class="Token ID">when</span><span class="Token SPACE"> </span><span class="Token ID">compiling</span><span class="Token SPACE"> </span><span class="Token ID">this</span><span class="Token SPACE"> </span><span class="Token ID">code.</span><span class="Token LF">
</span><span class="Token SPACE">      </span><span class="Token Program ID">This</span><span class="Token SPACE"> </span><span class="Token ID">version</span><span class="Token SPACE"> </span><span class="Token ID">of</span><span class="Token SPACE"> </span><span class="Token ID">the</span><span class="Token SPACE"> </span><span class="Token ID">code</span><span class="Token SPACE"> </span><span class="Token ID">uses</span><span class="Token SPACE"> </span><span class="Token ID">the</span><span class="Token SPACE"> </span><span class="Token ID">preprocesor</span><span class="Token SPACE"> </span><span class="Token ID">variable</span><span class="Token SPACE"> </span><span class="Token ID">STREAM_ARRAY_SIZE</span><span class="Token SPACE"> </span><span class="Token ID">to</span><span class="Token SPACE"> </span><span class="Token ID">control</span><span class="Token SPACE"> </span><span class="Token ID">the</span><span class="Token SPACE"> </span><span class="Token ID">array</span><span class="Token SPACE"> </span><span class="Token ID">size</span><span class="Token LF">
</span><span class="Token SPACE">      </span><span class="Token Program ID">Reverting</span><span class="Token SPACE"> </span><span class="Token ID">to</span><span class="Token SPACE"> </span><span class="Token ID">default</span><span class="Token SPACE"> </span><span class="Token ID">value</span><span class="Token SPACE"> </span><span class="Token ID">of</span><span class="Token SPACE"> </span><span class="Token Variant ID">STREAM_ARRAY_SIZE</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">10000000</span><span class="Token LF">
</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token SPACE">  </span><span class="Token Program ID">WARNING:</span><span class="Token SPACE"> </span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token MUL">*</span><span class="Token LF">
</span><span class="Token Program ID">Array</span><span class="Token SPACE"> </span><span class="Token Variant ID">size</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">10000000</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">elements</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Variant ID">Offset</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">0</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">elements</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token LF">
</span><span class="Token Program ID">Memory</span><span class="Token SPACE"> </span><span class="Token ID">per</span><span class="Token SPACE"> </span><span class="Token Variant ID">array</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">76.3</span><span class="Token SPACE"> </span><span class="Token Function ID">MiB</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">0.1</span><span class="Token SPACE"> </span><span class="Token ID">GiB</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token ID">.</span><span class="Token LF">
</span><span class="Token Program ID">Total</span><span class="Token SPACE"> </span><span class="Token ID">memory</span><span class="Token SPACE"> </span><span class="Token Variant ID">required</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">228.9</span><span class="Token SPACE"> </span><span class="Token Function ID">MiB</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">0.2</span><span class="Token SPACE"> </span><span class="Token ID">GiB</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token ID">.</span><span class="Token LF">
</span><span class="Token Program ID">Each</span><span class="Token SPACE"> </span><span class="Token ID">kernel</span><span class="Token SPACE"> </span><span class="Token ID">will</span><span class="Token SPACE"> </span><span class="Token ID">be</span><span class="Token SPACE"> </span><span class="Token ID">executed</span><span class="Token SPACE"> </span><span class="Token NUMBER">10</span><span class="Token SPACE"> </span><span class="Token ID">times.</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="Token Program ID">The</span><span class="Token SPACE"> </span><span class="Token MUL">*</span><span class="Token ID">best</span><span class="Token MUL">*</span><span class="Token SPACE"> </span><span class="Token ID">time</span><span class="Token SPACE"> </span><span class="Token Keyword FOR">for</span><span class="Token SPACE"> </span><span class="Token ID">each</span><span class="Token SPACE"> </span><span class="Token Function ID">kernel</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">excluding</span><span class="Token SPACE"> </span><span class="Token ID">the</span><span class="Token SPACE"> </span><span class="Token ID">first</span><span class="Token SPACE"> </span><span class="Token ID">iteration</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="Token Program ID">will</span><span class="Token SPACE"> </span><span class="Token ID">be</span><span class="Token SPACE"> </span><span class="Token ID">used</span><span class="Token SPACE"> </span><span class="Token ID">to</span><span class="Token SPACE"> </span><span class="Token ID">compute</span><span class="Token SPACE"> </span><span class="Token ID">the</span><span class="Token SPACE"> </span><span class="Token ID">reported</span><span class="Token SPACE"> </span><span class="Token ID">bandwidth.</span><span class="Token LF">
</span><span class="Token OPTION">-------------------------------------------------------------</span><span class="Token LF">
</span><span class="Token Program ID">Number</span><span class="Token SPACE"> </span><span class="Token ID">of</span><span class="Token SPACE"> </span><span class="Token ID">Threads</span><span class="Token SPACE"> </span><span class="Token Variant ID">requested</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">2</span><span class="Token LF">
</span><span class="Token Program ID">Number</span><span class="Token SPACE"> </span><span class="Token ID">of</span><span class="Token SPACE"> </span><span class="Token ID">Threads</span><span class="Token SPACE"> </span><span class="Token Variant ID">counted</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">2</span><span class="Token LF">
</span><span class="Token OPTION">-------------------------------------------------------------</span><span class="Token LF">
</span><span class="Token Program ID">Your</span><span class="Token SPACE"> </span><span class="Token ID">clock</span><span class="Token SPACE"> </span><span class="Token PATH">granularity/precision</span><span class="Token SPACE"> </span><span class="Token ID">appears</span><span class="Token SPACE"> </span><span class="Token ID">to</span><span class="Token SPACE"> </span><span class="Token ID">be</span><span class="Token SPACE"> </span><span class="Token NUMBER">998</span><span class="Token SPACE"> </span><span class="Token ID">microseconds.</span><span class="Token LF">
</span><span class="Token Program ID">Each</span><span class="Token SPACE"> </span><span class="Token ID">test</span><span class="Token SPACE"> </span><span class="Token ID">below</span><span class="Token SPACE"> </span><span class="Token ID">will</span><span class="Token SPACE"> </span><span class="Token ID">take</span><span class="Token SPACE"> </span><span class="Token ID">on</span><span class="Token SPACE"> </span><span class="Token ID">the</span><span class="Token SPACE"> </span><span class="Token ID">order</span><span class="Token SPACE"> </span><span class="Token ID">of</span><span class="Token SPACE"> </span><span class="Token NUMBER">19996</span><span class="Token SPACE"> </span><span class="Token ID">microseconds.</span><span class="Token LF">
</span><span class="Token SPACE">   </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">20</span><span class="Token SPACE"> </span><span class="Token Program ID">clock</span><span class="Token SPACE"> </span><span class="Token ID">ticks</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token LF">
</span><span class="Token Program ID">Increase</span><span class="Token SPACE"> </span><span class="Token ID">the</span><span class="Token SPACE"> </span><span class="Token ID">size</span><span class="Token SPACE"> </span><span class="Token ID">of</span><span class="Token SPACE"> </span><span class="Token ID">the</span><span class="Token SPACE"> </span><span class="Token ID">arrays</span><span class="Token SPACE"> </span><span class="Token Keyword IF">if</span><span class="Token SPACE"> </span><span class="Token ID">this</span><span class="Token SPACE"> </span><span class="Token ID">shows</span><span class="Token SPACE"> </span><span class="Token ID">that</span><span class="Token LF">
</span><span class="Token Program ID">you</span><span class="Token SPACE"> </span><span class="Token ID">are</span><span class="Token SPACE"> </span><span class="Token ID">not</span><span class="Token SPACE"> </span><span class="Token ID">getting</span><span class="Token SPACE"> </span><span class="Token ID">at</span><span class="Token SPACE"> </span><span class="Token ID">least</span><span class="Token SPACE"> </span><span class="Token NUMBER">20</span><span class="Token SPACE"> </span><span class="Token ID">clock</span><span class="Token SPACE"> </span><span class="Token ID">ticks</span><span class="Token SPACE"> </span><span class="Token ID">per</span><span class="Token SPACE"> </span><span class="Token ID">test.</span><span class="Token LF">
</span><span class="Token OPTION">-------------------------------------------------------------</span><span class="Token LF">
</span><span class="Token Program ID">WARNING</span><span class="Token SPACE"> </span><span class="Token OPTION">--</span><span class="Token SPACE"> </span><span class="Token ID">The</span><span class="Token SPACE"> </span><span class="Token ID">above</span><span class="Token SPACE"> </span><span class="Token ID">is</span><span class="Token SPACE"> </span><span class="Token ID">only</span><span class="Token SPACE"> </span><span class="Token ID">a</span><span class="Token SPACE"> </span><span class="Token ID">rough</span><span class="Token SPACE"> </span><span class="Token ID">guideline.</span><span class="Token LF">
</span><span class="Token Program ID">For</span><span class="Token SPACE"> </span><span class="Token ID">best</span><span class="Token SPACE"> </span><span class="Token ID">results</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token ID">please</span><span class="Token SPACE"> </span><span class="Token ID">be</span><span class="Token SPACE"> </span><span class="Token ID">sure</span><span class="Token SPACE"> </span><span class="Token ID">you</span><span class="Token SPACE"> </span><span class="Token ID">know</span><span class="Token SPACE"> </span><span class="Token ID">the</span><span class="Token LF">
</span><span class="Token Program ID">precision</span><span class="Token SPACE"> </span><span class="Token ID">of</span><span class="Token SPACE"> </span><span class="Token ID">your</span><span class="Token SPACE"> </span><span class="Token ID">system</span><span class="Token SPACE"> </span><span class="Token ID">timer.</span><span class="Token LF">
</span><span class="Token OPTION">-------------------------------------------------------------</span><span class="Token LF">
</span><span class="Token Program ID">Function</span><span class="Token SPACE">    </span><span class="Token ID">Best</span><span class="Token SPACE"> </span><span class="Token ID">Rate</span><span class="Token SPACE"> </span><span class="Token PATH">MB/s</span><span class="Token SPACE">  </span><span class="Token ID">Avg</span><span class="Token SPACE"> </span><span class="Token ID">time</span><span class="Token SPACE">     </span><span class="Token ID">Min</span><span class="Token SPACE"> </span><span class="Token ID">time</span><span class="Token SPACE">     </span><span class="Token ID">Max</span><span class="Token SPACE"> </span><span class="Token ID">time</span><span class="Token LF">
</span><span class="Token Program ID">Copy:</span><span class="Token SPACE">           </span><span class="Token NUMBER">11431.2</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.014109</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.013997</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.014998</span><span class="Token LF">
</span><span class="Token Program ID">Scale:</span><span class="Token SPACE">           </span><span class="Token NUMBER">7620.6</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.021330</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.020996</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.021997</span><span class="Token LF">
</span><span class="Token Program ID">Add:</span><span class="Token SPACE">            </span><span class="Token NUMBER">11430.8</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.021330</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.020996</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.021997</span><span class="Token LF">
</span><span class="Token Program ID">Triad:</span><span class="Token SPACE">           </span><span class="Token NUMBER">9232.2</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.026329</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.025996</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.026996</span><span class="Token LF">
</span><span class="Token OPTION">-------------------------------------------------------------</span></code></pre><ul><li><a href="https://zhuanlan.zhihu.com/p/407489860" target="_blank">Stream带宽测试的解释</a></li></ul><p>Array size = 10000000 (elements), Offset = 0 (elements)Memory per array = 76.3 MiB (= 0.1 GiB).Total memory required = 228.9 MiB (= 0.2 GiB).</p><pre class="language-shell"><code><span class="Token OPTION">-------------------------------------------------------------</span><span class="Token LF">
</span><span class="Token Program ID">Function</span><span class="Token SPACE">    </span><span class="Token ID">Best</span><span class="Token SPACE"> </span><span class="Token ID">Rate</span><span class="Token SPACE"> </span><span class="Token PATH">MB/s</span><span class="Token SPACE">  </span><span class="Token ID">Avg</span><span class="Token SPACE"> </span><span class="Token ID">time</span><span class="Token SPACE">     </span><span class="Token ID">Min</span><span class="Token SPACE"> </span><span class="Token ID">time</span><span class="Token SPACE">     </span><span class="Token ID">Max</span><span class="Token SPACE"> </span><span class="Token ID">time</span><span class="Token LF">
</span><span class="Token Program ID">Copy:</span><span class="Token SPACE">            </span><span class="Token NUMBER">4557.1</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.035114</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.035110</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.035137</span><span class="Token LF">
</span><span class="Token Program ID">Scale:</span><span class="Token SPACE">           </span><span class="Token NUMBER">3753.1</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.042634</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.042632</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.042636</span><span class="Token LF">
</span><span class="Token Program ID">Add:</span><span class="Token SPACE">             </span><span class="Token NUMBER">5037.0</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.047651</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.047647</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.047655</span><span class="Token LF">
</span><span class="Token Program ID">Triad:</span><span class="Token SPACE">           </span><span class="Token NUMBER">4557.4</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.052665</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.052662</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.052667</span><span class="Token LF">
</span><span class="Token OPTION">-------------------------------------------------------------</span><span class="Token LF">
</span></code></pre><pre class="language-shell"><code><span class="Token Program ID">cxl</span><span class="Token LF">
</span><span class="Token OPTION">-------------------------------------------------------------</span><span class="Token LF">
</span><span class="Token Program ID">Function</span><span class="Token SPACE">    </span><span class="Token ID">Best</span><span class="Token SPACE"> </span><span class="Token ID">Rate</span><span class="Token SPACE"> </span><span class="Token PATH">MB/s</span><span class="Token SPACE">  </span><span class="Token ID">Avg</span><span class="Token SPACE"> </span><span class="Token ID">time</span><span class="Token SPACE">     </span><span class="Token ID">Min</span><span class="Token SPACE"> </span><span class="Token ID">time</span><span class="Token SPACE">     </span><span class="Token ID">Max</span><span class="Token SPACE"> </span><span class="Token ID">time</span><span class="Token LF">
</span><span class="Token Program ID">Copy:</span><span class="Token SPACE">            </span><span class="Token NUMBER">5671.2</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.028214</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.028213</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.028217</span><span class="Token LF">
</span><span class="Token Program ID">Scale:</span><span class="Token SPACE">           </span><span class="Token NUMBER">3753.1</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.042637</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.042632</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.042660</span><span class="Token LF">
</span><span class="Token Program ID">Add:</span><span class="Token SPACE">             </span><span class="Token NUMBER">5629.7</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.042634</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.042631</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.042636</span><span class="Token LF">
</span><span class="Token Program ID">Triad:</span><span class="Token SPACE">           </span><span class="Token NUMBER">4557.3</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.052666</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.052663</span><span class="Token SPACE">     </span><span class="Token NUMBER">0.052667</span><span class="Token LF">
</span><span class="Token OPTION">-------------------------------------------------------------</span><span class="Token LF">
</span></code></pre><hr><h2 id="h2-3">Redis</h2><pre class="language-shell"><code><span class="Token Program ID">wget</span><span class="Token SPACE"> </span><span class="Token Url ID">https://download.redis.io/redis-stable.tar.gz</span><span class="Token LF">
</span><span class="Token Program ID">tar</span><span class="Token SPACE"> </span><span class="Token OPTION">-xzvf</span><span class="Token SPACE"> </span><span class="Token ID">redis-stable.tar.gz</span><span class="Token LF">
</span><span class="Token Keyword CD">cd</span><span class="Token SPACE"> </span><span class="Token ID">redis-stable</span><span class="Token LF">
</span><span class="Token Program ID">make</span><span class="Token LF">
</span><span class="Token Program ID">sudo</span><span class="Token SPACE"> </span><span class="Token ID">make</span><span class="Token SPACE"> </span><span class="Token ID">install</span><span class="Token LF">
</span><span class="Token Program ID">redis-server</span></code></pre><pre class="language-shell"><code><span class="Token COMMENT"># 本机测试结果</span><span class="Token LF">
</span><span class="Token VARIANT">$</span><span class="Token SPACE"> </span><span class="Token Program ID">redis-benchmark</span><span class="Token SPACE"> </span><span class="Token OPTION">-q</span><span class="Token SPACE"> </span><span class="Token OPTION">-n</span><span class="Token SPACE"> </span><span class="Token NUMBER">100000</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token Program ID">PING_INLINE:</span><span class="Token SPACE"> </span><span class="Token NUMBER">227272.73</span><span class="Token SPACE"> </span><span class="Token ID">requests</span><span class="Token SPACE"> </span><span class="Token ID">per</span><span class="Token SPACE"> </span><span class="Token ID">second</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Variant ID">p50</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">0.111</span><span class="Token SPACE"> </span><span class="Token ID">msec</span><span class="Token LF">
</span><span class="Token Program ID">PING_MBULK:</span><span class="Token SPACE"> </span><span class="Token NUMBER">222222.22</span><span class="Token SPACE"> </span><span class="Token ID">requests</span><span class="Token SPACE"> </span><span class="Token ID">per</span><span class="Token SPACE"> </span><span class="Token ID">second</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Variant ID">p50</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">0.111</span><span class="Token SPACE"> </span><span class="Token ID">msec</span><span class="Token LF">
</span><span class="Token Program ID">SET:</span><span class="Token SPACE"> </span><span class="Token NUMBER">227272.73</span><span class="Token SPACE"> </span><span class="Token ID">requests</span><span class="Token SPACE"> </span><span class="Token ID">per</span><span class="Token SPACE"> </span><span class="Token ID">second</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Variant ID">p50</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">0.111</span><span class="Token SPACE"> </span><span class="Token ID">msec</span><span class="Token LF">
</span><span class="Token Program ID">GET:</span><span class="Token SPACE"> </span><span class="Token NUMBER">227272.73</span><span class="Token SPACE"> </span><span class="Token ID">requests</span><span class="Token SPACE"> </span><span class="Token ID">per</span><span class="Token SPACE"> </span><span class="Token ID">second</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Variant ID">p50</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">0.111</span><span class="Token SPACE"> </span><span class="Token ID">msec</span><span class="Token LF">
</span><span class="Token Program ID">INCR:</span><span class="Token SPACE"> </span><span class="Token NUMBER">227272.73</span><span class="Token SPACE"> </span><span class="Token ID">requests</span><span class="Token SPACE"> </span><span class="Token ID">per</span><span class="Token SPACE"> </span><span class="Token ID">second</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Variant ID">p50</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">0.111</span><span class="Token SPACE"> </span><span class="Token ID">msec</span><span class="Token LF">
</span><span class="Token Program ID">LPUSH:</span><span class="Token SPACE"> </span><span class="Token NUMBER">232558.12</span><span class="Token SPACE"> </span><span class="Token ID">requests</span><span class="Token SPACE"> </span><span class="Token ID">per</span><span class="Token SPACE"> </span><span class="Token ID">second</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Variant ID">p50</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">0.111</span><span class="Token SPACE"> </span><span class="Token ID">msec</span><span class="Token LF">
</span><span class="Token Program ID">RPUSH:</span><span class="Token SPACE"> </span><span class="Token NUMBER">227272.73</span><span class="Token SPACE"> </span><span class="Token ID">requests</span><span class="Token SPACE"> </span><span class="Token ID">per</span><span class="Token SPACE"> </span><span class="Token ID">second</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Variant ID">p50</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">0.111</span><span class="Token SPACE"> </span><span class="Token ID">msec</span><span class="Token LF">
</span><span class="Token Program ID">LPOP:</span><span class="Token SPACE"> </span><span class="Token NUMBER">232558.12</span><span class="Token SPACE"> </span><span class="Token ID">requests</span><span class="Token SPACE"> </span><span class="Token ID">per</span><span class="Token SPACE"> </span><span class="Token ID">second</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Variant ID">p50</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">0.111</span><span class="Token SPACE"> </span><span class="Token ID">msec</span><span class="Token LF">
</span><span class="Token Program ID">RPOP:</span><span class="Token SPACE"> </span><span class="Token NUMBER">232558.12</span><span class="Token SPACE"> </span><span class="Token ID">requests</span><span class="Token SPACE"> </span><span class="Token ID">per</span><span class="Token SPACE"> </span><span class="Token ID">second</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Variant ID">p50</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">0.111</span><span class="Token SPACE"> </span><span class="Token ID">msec</span><span class="Token LF">
</span><span class="Token Program ID">SADD:</span><span class="Token SPACE"> </span><span class="Token NUMBER">232558.12</span><span class="Token SPACE"> </span><span class="Token ID">requests</span><span class="Token SPACE"> </span><span class="Token ID">per</span><span class="Token SPACE"> </span><span class="Token ID">second</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Variant ID">p50</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">0.111</span><span class="Token SPACE"> </span><span class="Token ID">msec</span><span class="Token LF">
</span><span class="Token Program ID">HSET:</span><span class="Token SPACE"> </span><span class="Token NUMBER">238095.23</span><span class="Token SPACE"> </span><span class="Token ID">requests</span><span class="Token SPACE"> </span><span class="Token ID">per</span><span class="Token SPACE"> </span><span class="Token ID">second</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Variant ID">p50</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">0.111</span><span class="Token SPACE"> </span><span class="Token ID">msec</span><span class="Token LF">
</span><span class="Token Program ID">SPOP:</span><span class="Token SPACE"> </span><span class="Token NUMBER">238095.23</span><span class="Token SPACE"> </span><span class="Token ID">requests</span><span class="Token SPACE"> </span><span class="Token ID">per</span><span class="Token SPACE"> </span><span class="Token ID">second</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Variant ID">p50</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">0.111</span><span class="Token SPACE"> </span><span class="Token ID">msec</span><span class="Token LF">
</span><span class="Token Program ID">ZADD:</span><span class="Token SPACE"> </span><span class="Token NUMBER">238095.23</span><span class="Token SPACE"> </span><span class="Token ID">requests</span><span class="Token SPACE"> </span><span class="Token ID">per</span><span class="Token SPACE"> </span><span class="Token ID">second</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Variant ID">p50</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">0.111</span><span class="Token SPACE"> </span><span class="Token ID">msec</span><span class="Token LF">
</span><span class="Token Program ID">ZPOPMIN:</span><span class="Token SPACE"> </span><span class="Token NUMBER">238095.23</span><span class="Token SPACE"> </span><span class="Token ID">requests</span><span class="Token SPACE"> </span><span class="Token ID">per</span><span class="Token SPACE"> </span><span class="Token ID">second</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Variant ID">p50</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">0.111</span><span class="Token SPACE"> </span><span class="Token ID">msec</span><span class="Token LF">
</span><span class="Token Function Program ID">LPUSH</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">needed</span><span class="Token SPACE"> </span><span class="Token ID">to</span><span class="Token SPACE"> </span><span class="Token ID">benchmark</span><span class="Token SPACE"> </span><span class="Token ID">LRANGE</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COLON">:</span><span class="Token SPACE"> </span><span class="Token NUMBER">238095.23</span><span class="Token SPACE"> </span><span class="Token ID">requests</span><span class="Token SPACE"> </span><span class="Token ID">per</span><span class="Token SPACE"> </span><span class="Token ID">second</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Variant ID">p50</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">0.111</span><span class="Token SPACE"> </span><span class="Token ID">msec</span><span class="Token LF">
</span><span class="Token Function Program ID">LRANGE_100</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">first</span><span class="Token SPACE"> </span><span class="Token NUMBER">100</span><span class="Token SPACE"> </span><span class="Token ID">elements</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COLON">:</span><span class="Token SPACE"> </span><span class="Token NUMBER">123456.79</span><span class="Token SPACE"> </span><span class="Token ID">requests</span><span class="Token SPACE"> </span><span class="Token ID">per</span><span class="Token SPACE"> </span><span class="Token ID">second</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Variant ID">p50</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">0.207</span><span class="Token SPACE"> </span><span class="Token ID">msec</span><span class="Token LF">
</span><span class="Token Function Program ID">LRANGE_300</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">first</span><span class="Token SPACE"> </span><span class="Token NUMBER">300</span><span class="Token SPACE"> </span><span class="Token ID">elements</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COLON">:</span><span class="Token SPACE"> </span><span class="Token NUMBER">48076.92</span><span class="Token SPACE"> </span><span class="Token ID">requests</span><span class="Token SPACE"> </span><span class="Token ID">per</span><span class="Token SPACE"> </span><span class="Token ID">second</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Variant ID">p50</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">0.511</span><span class="Token SPACE"> </span><span class="Token ID">msec</span><span class="Token LF">
</span><span class="Token Function Program ID">LRANGE_500</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">first</span><span class="Token SPACE"> </span><span class="Token NUMBER">500</span><span class="Token SPACE"> </span><span class="Token ID">elements</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COLON">:</span><span class="Token SPACE"> </span><span class="Token NUMBER">31948.88</span><span class="Token SPACE"> </span><span class="Token ID">requests</span><span class="Token SPACE"> </span><span class="Token ID">per</span><span class="Token SPACE"> </span><span class="Token ID">second</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Variant ID">p50</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">0.775</span><span class="Token SPACE"> </span><span class="Token ID">msec</span><span class="Token LF">
</span><span class="Token Function Program ID">LRANGE_600</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">first</span><span class="Token SPACE"> </span><span class="Token NUMBER">600</span><span class="Token SPACE"> </span><span class="Token ID">elements</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COLON">:</span><span class="Token SPACE"> </span><span class="Token NUMBER">27472.53</span><span class="Token SPACE"> </span><span class="Token ID">requests</span><span class="Token SPACE"> </span><span class="Token ID">per</span><span class="Token SPACE"> </span><span class="Token ID">second</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Variant ID">p50</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">0.903</span><span class="Token SPACE"> </span><span class="Token ID">msec</span><span class="Token LF">
</span><span class="Token Function Program ID">MSET</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token NUMBER">10</span><span class="Token SPACE"> </span><span class="Token ID">keys</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COLON">:</span><span class="Token SPACE"> </span><span class="Token NUMBER">232558.12</span><span class="Token SPACE"> </span><span class="Token ID">requests</span><span class="Token SPACE"> </span><span class="Token ID">per</span><span class="Token SPACE"> </span><span class="Token ID">second</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Variant ID">p50</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">0.183</span><span class="Token SPACE"> </span><span class="Token ID">msec</span></code></pre><hr><h2 id="h2-4">驱动测试</h2><pre class="language-shell"><code><span class="Token HOST_NAME">root@gem5-host</span><span class="Token COLON">:</span><span class="Token DIR_PATH">/home/benchmark</span><span class="Token TAG">#</span><span class="Token SPACE"> </span><span class="Token Program PATH">./test1</span><span class="Token LF">
</span><span class="Token ID">写入前:0</span><span class="Token LF">
</span><span class="Token ID">写入后:65</span><span class="Token LF">
</span><span class="Token HOST_NAME">root@gem5-host</span><span class="Token COLON">:</span><span class="Token DIR_PATH">/home/benchmark</span><span class="Token TAG">#</span><span class="Token SPACE"> </span><span class="Token Program PATH">./test2</span><span class="Token LF">
</span><span class="Token Program ID">before</span><span class="Token SPACE"> </span><span class="Token ID">mmap</span><span class="Token LF">
</span><span class="Token Program ID">after</span><span class="Token SPACE"> </span><span class="Token ID">mmap</span><span class="Token LF">
</span><span class="Token ID">原始数据:A</span><span class="Token LF">
</span><span class="Token Variant Program ID">buf</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">hello</span><span class="Token COMMA">,</span><span class="Token ID">world</span><span class="Token BANG">!</span></code></pre><pre class="language-shell"><code><span class="Token Program ID">read</span><span class="Token SPACE"> </span><span class="Token Variant ID">data</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token LF">
</span><span class="Token Program ID">write</span><span class="Token SPACE"> </span><span class="Token Variant ID">data</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">A</span><span class="Token LF">
</span><span class="Token Program ID">write</span><span class="Token SPACE"> </span><span class="Token Variant ID">data</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">B</span><span class="Token LF">
</span><span class="Token Program ID">write</span><span class="Token SPACE"> </span><span class="Token Variant ID">data</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">C</span><span class="Token LF">
</span><span class="Token Program ID">read</span><span class="Token SPACE"> </span><span class="Token Variant ID">data</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">A</span><span class="Token LF">
</span><span class="Token Program ID">read</span><span class="Token SPACE"> </span><span class="Token Variant ID">data</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">A</span><span class="Token LF">
</span><span class="Token Program ID">read</span><span class="Token SPACE"> </span><span class="Token Variant ID">data</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">C</span><span class="Token LF">
</span><span class="Token Program ID">read</span><span class="Token SPACE"> </span><span class="Token Variant ID">data</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">A</span><span class="Token LF">
</span><span class="Token Program ID">read</span><span class="Token SPACE"> </span><span class="Token Variant ID">data</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">A</span><span class="Token LF">
</span><span class="Token Program ID">write</span><span class="Token SPACE"> </span><span class="Token Variant ID">data</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">hello</span><span class="Token COMMA">,</span><span class="Token ID">wo</span><span class="Token TEXT">�</span><span class="Token String STRING">&quot;=&#x27;V
write data = rld!
write data =
read data = hello,wo�yx$V
read data = rld!&quot;</span></code></pre><h2 id="h2-5">memkind/vmem分配CXL设备内存的测试</h2><blockquote><p><a href="https://blog.csdn.net/qq_45726331/article/details/129824342" target="_blank">【CXL】使用memkind/vmem管理CXL扩展内存</a></p></blockquote><p>我们这里使用之前下载的 <code>full-system-image/disks/parsec.img</code> 磁盘镜像, 创建目录并挂载vfs, 假设此时位于 <code>~/gem5/full-system-image/disks</code> 目录下, 即 parsec.img 同级目录</p><p>挂载镜像文件到 local_mnt 目录</p><pre class="language-shell"><code><span class="Token Program ID">mkdir</span><span class="Token SPACE"> </span><span class="Token ID">local_mnt</span><span class="Token LF">
</span><span class="Token Program ID">sudo</span><span class="Token SPACE"> </span><span class="Token ID">mount</span><span class="Token SPACE"> </span><span class="Token OPTION">-o</span><span class="Token SPACE"> </span><span class="Token ID">loop</span><span class="Token COMMA">,</span><span class="Token Variant ID">offset</span><span class="Token ASSIGN">=</span><span class="Token DOLLAR">$</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token BraceDepth-1 LPAREN">(</span><span class="Token NUMBER">2048</span><span class="Token MUL">*</span><span class="Token NUMBER">512</span><span class="Token BraceDepth-1 RPAREN">)</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token Program ID">parsec.img</span><span class="Token SPACE"> </span><span class="Token ID">local_mnt</span><span class="Token LF">
</span><span class="Token Program ID">sudo</span><span class="Token SPACE"> </span><span class="Token ID">mount</span><span class="Token SPACE"> </span><span class="Token OPTION">-o</span><span class="Token SPACE"> </span><span class="Token ID">bind</span><span class="Token SPACE"> </span><span class="Token PATH">/proc</span><span class="Token SPACE"> </span><span class="Token PATH">local_mnt/proc</span><span class="Token LF">
</span><span class="Token Program ID">sudo</span><span class="Token SPACE"> </span><span class="Token ID">mount</span><span class="Token SPACE"> </span><span class="Token OPTION">-o</span><span class="Token SPACE"> </span><span class="Token ID">bind</span><span class="Token SPACE"> </span><span class="Token PATH">/dev</span><span class="Token SPACE"> </span><span class="Token PATH">local_mnt/dev</span><span class="Token LF">
</span><span class="Token Program ID">sudo</span><span class="Token SPACE"> </span><span class="Token ID">mount</span><span class="Token SPACE"> </span><span class="Token OPTION">-o</span><span class="Token SPACE"> </span><span class="Token ID">bind</span><span class="Token SPACE"> </span><span class="Token PATH">/dev/pts</span><span class="Token SPACE"> </span><span class="Token PATH">local_mnt/dev/pts</span><span class="Token LF">
</span><span class="Token Program ID">sudo</span><span class="Token SPACE"> </span><span class="Token ID">mount</span><span class="Token SPACE"> </span><span class="Token OPTION">-o</span><span class="Token SPACE"> </span><span class="Token ID">bind</span><span class="Token SPACE"> </span><span class="Token PATH">/sys</span><span class="Token SPACE"> </span><span class="Token PATH">local_mnt/sys</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token Keyword CD">cd</span><span class="Token SPACE"> </span><span class="Token ID">local_mnt</span><span class="Token LF">
</span><span class="Token Program ID">sudo</span><span class="Token SPACE"> </span><span class="Token ID">chroot</span><span class="Token SPACE"> </span><span class="Token PATH">./</span></code></pre><pre class="language-shell"><code><span class="Token Program ID">mkdir</span><span class="Token SPACE"> </span><span class="Token PATH">/home/lib_source_code</span></code></pre><p><a href="https://github.com/pmem/pmdk/releases/tag/1.4" target="_blank">PMDK Version 1.4</a></p><pre class="language-shell"><code><span class="Token Program ID">wget</span><span class="Token SPACE"> </span><span class="Token Url ID">https://github.com/pmem/pmdk/releases/download/1.4/pmdk-1.4-dpkgs.tar.gz</span><span class="Token LF">
</span><span class="Token Program ID">wget</span><span class="Token SPACE"> </span><span class="Token Url ID">https://github.com/memkind/memkind/archive/refs/tags/v1.14.0.tar.gz</span><span class="Token LF">
</span><span class="Token Program ID">wget</span><span class="Token SPACE"> </span><span class="Token Url ID">http://ftp.jaist.ac.jp/pub/GNU/libtool/libtool-2.4.6.tar.gz</span><span class="Token LF">
</span><span class="Token Program ID">wget</span><span class="Token SPACE"> </span><span class="Token Url ID">https://github.com/numactl/numactl/releases/download/v2.0.16/numactl-2.0.16.tar.gz</span></code></pre><pre class="language-shell"><code><span class="Token Keyword CD">cd</span><span class="Token SPACE"> </span><span class="Token PATH">/home/lib_source_code/</span><span class="Token LF">
</span><span class="Token Program ID">dpkg</span><span class="Token SPACE"> </span><span class="Token OPTION">-i</span><span class="Token SPACE"> </span><span class="Token ID">libvmem_1.4-1_amd64.deb</span><span class="Token LF">
</span><span class="Token Program ID">dpkg</span><span class="Token SPACE"> </span><span class="Token OPTION">-l</span><span class="Token SPACE"> </span><span class="Token PIPE">|</span><span class="Token SPACE"> </span><span class="Token Program ID">grep</span><span class="Token SPACE"> </span><span class="Token ID">libvmem</span></code></pre><pre class="language-shell"><code><span class="Token HOST_NAME">root@LZX</span><span class="Token COLON">:</span><span class="Token DIR_PATH">/home</span><span class="Token TAG">#</span><span class="Token SPACE"> </span><span class="Token Program ID">dpkg</span><span class="Token SPACE"> </span><span class="Token OPTION">-l</span><span class="Token SPACE"> </span><span class="Token PIPE">|</span><span class="Token SPACE"> </span><span class="Token Program ID">grep</span><span class="Token SPACE"> </span><span class="Token ID">libvmem</span><span class="Token LF">
</span><span class="Token Program ID">ii</span><span class="Token SPACE">  </span><span class="Token ID">libvmem</span><span class="Token SPACE">                               </span><span class="Token NUMBER">1.4</span><span class="Token MINUS">-</span><span class="Token NUMBER">1</span><span class="Token SPACE">                               </span><span class="Token ID">amd64</span><span class="Token SPACE">        </span><span class="Token ID">PMDK</span><span class="Token SPACE"> </span><span class="Token ID">libvmem</span><span class="Token SPACE"> </span><span class="Token ID">library</span><span class="Token LF">
</span><span class="Token HOST_NAME">root@LZX</span><span class="Token COLON">:</span><span class="Token DIR_PATH">/home</span><span class="Token TAG">#</span><span class="Token SPACE"> </span><span class="Token Program ID">dpkg</span><span class="Token SPACE"> </span><span class="Token OPTION">-L</span><span class="Token SPACE"> </span><span class="Token ID">libvmem</span><span class="Token LF">
</span><span class="Token Program PATH">/.</span><span class="Token LF">
</span><span class="Token Program PATH">/usr</span><span class="Token LF">
</span><span class="Token Program PATH">/usr/lib</span><span class="Token LF">
</span><span class="Token Program PATH">/usr/lib/x86_64-linux-gnu</span><span class="Token LF">
</span><span class="Token Program PATH">/usr/lib/x86_64-linux-gnu/libvmem.so.1.0.0</span><span class="Token LF">
</span><span class="Token Program PATH">/usr/share</span><span class="Token LF">
</span><span class="Token Program PATH">/usr/share/doc</span><span class="Token LF">
</span><span class="Token Program PATH">/usr/share/doc/libvmem</span><span class="Token LF">
</span><span class="Token Program PATH">/usr/share/doc/libvmem/changelog.Debian.gz</span><span class="Token LF">
</span><span class="Token Program PATH">/usr/share/doc/libvmem/copyright</span><span class="Token LF">
</span><span class="Token Program PATH">/usr/share/lintian</span><span class="Token LF">
</span><span class="Token Program PATH">/usr/share/lintian/overrides</span><span class="Token LF">
</span><span class="Token Program PATH">/usr/share/lintian/overrides/libvmem</span><span class="Token LF">
</span><span class="Token Program PATH">/usr/lib/x86_64-linux-gnu/libvmem.so.1</span></code></pre><p><a data-lightbox="example-1" href="https://raw.githubusercontent.com/learner-lu/picbed/master/20230403021208.png"><img src="https://raw.githubusercontent.com/learner-lu/picbed/master/20230403021208.png" alt="20230403021208"></a></p><pre class="language-shell"><code><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">libtool-2.4.6</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">libvmem_1.4-1_amd64.deb</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">memkind-1.14.0</span><span class="Token LF">
</span><span class="Token TEXT">└</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">numactl-2.0.16</span></code></pre><pre class="language-shell"><code><span class="Token Keyword CD">cd</span><span class="Token SPACE"> </span><span class="Token ID">numactl-2.0.16</span><span class="Token LF">
</span><span class="Token Program PATH">./configure</span><span class="Token SPACE"> </span><span class="Token OPTION">--prefix</span><span class="Token ASSIGN">=</span><span class="Token PATH">/usr/</span><span class="Token LF">
</span><span class="Token Program ID">make</span><span class="Token SPACE"> </span><span class="Token OPTION">-j4</span><span class="Token LF">
</span><span class="Token Program ID">make</span><span class="Token SPACE"> </span><span class="Token ID">install</span></code></pre><pre class="language-shell"><code><span class="Token HOST_NAME">root@LZX</span><span class="Token COLON">:</span><span class="Token DIR_PATH">/home/lib_source_code/numactl</span><span class="Token TAG"></span><span class="Token SPACE"> </span><span class="Token Program ID">ls</span><span class="Token SPACE"> </span><span class="Token PATH">/usr/lib/</span><span class="Token SPACE"> </span><span class="Token PIPE">|</span><span class="Token SPACE"> </span><span class="Token Program ID">grep</span><span class="Token SPACE"> </span><span class="Token ID">libnuma</span><span class="Token LF">
</span><span class="Token Program ID">libnuma.a</span><span class="Token LF">
</span><span class="Token Program ID">libnuma.la</span><span class="Token LF">
</span><span class="Token Program ID">libnuma.so</span><span class="Token LF">
</span><span class="Token Program ID">libnuma.so.1</span><span class="Token LF">
</span><span class="Token Program ID">libnuma.so.1.0.0</span></code></pre><pre class="language-shell"><code><span class="Token Keyword CD">cd</span><span class="Token SPACE"> </span><span class="Token ID">libtool-2.4.6</span><span class="Token LF">
</span><span class="Token Program PATH">./configure</span><span class="Token SPACE"> </span><span class="Token OPTION">--prefix</span><span class="Token ASSIGN">=</span><span class="Token PATH">/usr/</span><span class="Token LF">
</span><span class="Token Program ID">make</span><span class="Token LF">
</span><span class="Token Program ID">make</span><span class="Token SPACE"> </span><span class="Token ID">install</span></code></pre><blockquote><p>这里的 make 执行第一遍会出错, 文件夹删了, 第二遍就好了?</p></blockquote><pre class="language-shell"><code><span class="Token HOST_NAME">root@LZX</span><span class="Token COLON">:</span><span class="Token DIR_PATH">/home/lib_source_code/libtool</span><span class="Token TAG"></span><span class="Token SPACE"> </span><span class="Token Program ID">ls</span><span class="Token SPACE"> </span><span class="Token PATH">/usr/lib/</span><span class="Token SPACE"> </span><span class="Token PIPE">|</span><span class="Token SPACE"> </span><span class="Token Program ID">grep</span><span class="Token SPACE"> </span><span class="Token ID">ltdl</span><span class="Token LF">
</span><span class="Token Program ID">libltdl.a</span><span class="Token LF">
</span><span class="Token Program ID">libltdl.la</span><span class="Token LF">
</span><span class="Token Program ID">libltdl.so</span><span class="Token LF">
</span><span class="Token Program ID">libltdl.so.7</span><span class="Token LF">
</span><span class="Token Program ID">libltdl.so.7.3.1</span></code></pre><pre class="language-shell"><code><span class="Token HOST_NAME">root@LZX</span><span class="Token COLON">:</span><span class="Token DIR_PATH">/home/lib_source_code/memkind</span><span class="Token TAG"></span><span class="Token SPACE"> </span><span class="Token Program PATH">./autogen.sh</span><span class="Token LF">
</span><span class="Token Program ID">libtoolize:</span><span class="Token SPACE"> </span><span class="Token ID">putting</span><span class="Token SPACE"> </span><span class="Token ID">auxiliary</span><span class="Token SPACE"> </span><span class="Token ID">files</span><span class="Token SPACE"> </span><span class="Token Keyword IN">in</span><span class="Token SPACE"> </span><span class="Token APOSTROPHE">&#x27;</span><span class="Token ID">.</span><span class="Token APOSTROPHE">&#x27;</span><span class="Token ID">.</span><span class="Token LF">
</span><span class="Token Program ID">libtoolize:</span><span class="Token SPACE"> </span><span class="Token ID">copying</span><span class="Token SPACE"> </span><span class="Token ID">file</span><span class="Token SPACE"> </span><span class="Token APOSTROPHE">&#x27;</span><span class="Token PATH">./ltmain.sh</span><span class="Token APOSTROPHE">&#x27;</span><span class="Token LF">
</span><span class="Token Program ID">libtoolize:</span><span class="Token SPACE"> </span><span class="Token ID">putting</span><span class="Token SPACE"> </span><span class="Token ID">macros</span><span class="Token SPACE"> </span><span class="Token Keyword IN">in</span><span class="Token SPACE"> </span><span class="Token ID">AC_CONFIG_MACRO_DIRS</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token APOSTROPHE">&#x27;</span><span class="Token ID">m4</span><span class="Token APOSTROPHE">&#x27;</span><span class="Token ID">.</span><span class="Token LF">
</span><span class="Token Program ID">libtoolize:</span><span class="Token SPACE"> </span><span class="Token ID">copying</span><span class="Token SPACE"> </span><span class="Token ID">file</span><span class="Token SPACE"> </span><span class="Token APOSTROPHE">&#x27;</span><span class="Token PATH">m4/libtool.m4</span><span class="Token APOSTROPHE">&#x27;</span><span class="Token LF">
</span><span class="Token Program ID">libtoolize:</span><span class="Token SPACE"> </span><span class="Token ID">copying</span><span class="Token SPACE"> </span><span class="Token ID">file</span><span class="Token SPACE"> </span><span class="Token APOSTROPHE">&#x27;</span><span class="Token PATH">m4/ltoptions.m4</span><span class="Token APOSTROPHE">&#x27;</span><span class="Token LF">
</span><span class="Token Program ID">libtoolize:</span><span class="Token SPACE"> </span><span class="Token ID">copying</span><span class="Token SPACE"> </span><span class="Token ID">file</span><span class="Token SPACE"> </span><span class="Token APOSTROPHE">&#x27;</span><span class="Token PATH">m4/ltsugar.m4</span><span class="Token APOSTROPHE">&#x27;</span><span class="Token LF">
</span><span class="Token Program ID">libtoolize:</span><span class="Token SPACE"> </span><span class="Token ID">copying</span><span class="Token SPACE"> </span><span class="Token ID">file</span><span class="Token SPACE"> </span><span class="Token APOSTROPHE">&#x27;</span><span class="Token PATH">m4/ltversion.m4</span><span class="Token APOSTROPHE">&#x27;</span><span class="Token LF">
</span><span class="Token Program ID">libtoolize:</span><span class="Token SPACE"> </span><span class="Token ID">copying</span><span class="Token SPACE"> </span><span class="Token ID">file</span><span class="Token SPACE"> </span><span class="Token APOSTROPHE">&#x27;</span><span class="Token PATH">m4/lt~obsolete.m4</span><span class="Token APOSTROPHE">&#x27;</span></code></pre><pre class="language-shell"><code><span class="Token Program PATH">./configure</span><span class="Token SPACE"> </span><span class="Token OPTION">--prefix</span><span class="Token ASSIGN">=</span><span class="Token PATH">/usr/</span><span class="Token LF">
</span><span class="Token Program ID">make</span><span class="Token LF">
</span><span class="Token Program ID">make</span><span class="Token SPACE"> </span><span class="Token ID">install</span></code></pre><pre class="language-shell"><code><span class="Token HOST_NAME">root@LZX</span><span class="Token COLON">:</span><span class="Token DIR_PATH">/home/lib_source_code/memkind</span><span class="Token TAG"></span><span class="Token SPACE"> </span><span class="Token Program ID">ls</span><span class="Token SPACE"> </span><span class="Token PATH">/usr/lib/</span><span class="Token SPACE"> </span><span class="Token PIPE">|</span><span class="Token SPACE"> </span><span class="Token Program ID">grep</span><span class="Token SPACE"> </span><span class="Token ID">kind</span><span class="Token LF">
</span><span class="Token Program ID">libmemkind.a</span><span class="Token LF">
</span><span class="Token Program ID">libmemkind.la</span><span class="Token LF">
</span><span class="Token Program ID">libmemkind.so</span><span class="Token LF">
</span><span class="Token Program ID">libmemkind.so.0</span><span class="Token LF">
</span><span class="Token Program ID">libmemkind.so.0.0.1</span></code></pre><p>卸载镜像</p><pre class="language-shell"><code><span class="Token Program ID">sudo</span><span class="Token SPACE"> </span><span class="Token ID">umount</span><span class="Token SPACE"> </span><span class="Token PATH">local_mnt/proc</span><span class="Token LF">
</span><span class="Token Program ID">sudo</span><span class="Token SPACE"> </span><span class="Token ID">umount</span><span class="Token SPACE"> </span><span class="Token PATH">local_mnt/dev/pts</span><span class="Token LF">
</span><span class="Token Program ID">sudo</span><span class="Token SPACE"> </span><span class="Token ID">umount</span><span class="Token SPACE"> </span><span class="Token PATH">local_mnt/dev</span><span class="Token LF">
</span><span class="Token Program ID">sudo</span><span class="Token SPACE"> </span><span class="Token ID">umount</span><span class="Token SPACE"> </span><span class="Token PATH">local_mnt/sys</span><span class="Token LF">
</span><span class="Token Program ID">sudo</span><span class="Token SPACE"> </span><span class="Token ID">umount</span><span class="Token SPACE"> </span><span class="Token ID">local_mnt</span></code></pre><h2 id="h2-6">参考</h2></div>
    <div class="dir-tree"><ul><li><a href="../../md-docs/README" >README</a></li></ul><ul><li><a href="../../gem5的编译和使用/gem5简介" >gem5的编译和使用</a><ul><li><a href="../../gem5的编译和使用/gem5简介" >gem5简介</a></li></ul><ul><li><a href="../../gem5的编译和使用/安装与构建" >安装与构建</a></li></ul><ul><li><a href="../../gem5的编译和使用/第一个程序" >第一个程序</a></li></ul><ul><li><a href="../../gem5的编译和使用/全系统模拟" >全系统模拟</a></li></ul><ul><li><a href="../../gem5的编译和使用/linux-kernel构建" >linux-kernel构建</a></li></ul><ul><li><a href="../../gem5的编译和使用/性能测试与统计结果" >性能测试与统计结果</a></li></ul></li></ul><ul><li><a href="../../pybind11/环境配置" >pybind11</a><ul><li><a href="../../pybind11/环境配置" >环境配置</a></li></ul><ul><li><a href="../../pybind11/基础语法" >基础语法</a></li></ul><ul><li><a href="../../pybind11/面向对象" >面向对象</a></li></ul></li></ul><ul><li><a href="../../gem5源码分析/环境配置" >gem5源码分析</a><ul><li><a href="../../gem5源码分析/环境配置" >环境配置</a></li></ul><ul><li><a href="../../gem5源码分析/scons编译流程" >scons编译流程</a></li></ul><ul><li><a href="../../gem5源码分析/gem5启动流程" >gem5启动流程</a></li></ul><ul><li><a href="../../gem5源码分析/SimObject" >SimObject</a></li></ul></li></ul></div>
    <div class="zood"><a class="" href="https://github.com/luzhixing12345/zood" target="_blank">zood</a></div>
    <script type="text/javascript" src="../../../js/next_front.js"></script><script>addLink("../../gem5的编译和使用/linux-kernel构建","../../pybind11/环境配置","ab")</script><script type="text/javascript" src="../../../js/change_mode.js"></script><script>addChangeModeButton("../../../img/sun.png","../../../img/moon.png")</script><script type="text/javascript" src="../../../js/copy_code.js"></script><script>addCodeCopy("../../../img/before_copy.png","../../../img/after_copy.png")</script><script type="text/javascript" src="../../../js/navigator.js"></script><script type="text/javascript" src="../../../js/picture_preview.js"></script><script type="text/javascript" src="../../../js/global_js_configuration.js"></script>
</body>

</html>
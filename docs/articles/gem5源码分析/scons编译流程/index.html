<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        Document
    </title>
    <link rel='stylesheet' href=../../../css/index.css />
    <link rel='stylesheet' href=../../../css/c.css /><link rel='stylesheet' href=../../../css/json.css /><link rel='stylesheet' href=../../../css/python.css /><link rel='stylesheet' href=../../../css/shell.css />
    <link rel="icon" href="https://raw.githubusercontent.com/learner-lu/picbed/master/logo.png">
</head>

<body class="light">
    <a href="https://github.com/luzhixing12345/gem5-doc.git" target="_blank" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    <div class="header-navigator"><ul><li><a href="#h1-0">scons编译流程</a><ul><li><a href="#h2-1">gem5 目录结构</a></li></ul><ul><li><a href="#h2-2">具体的编译流程与细节</a></li></ul><ul><li><a href="#h2-3">结语</a></li></ul></li></ul></div><div class='markdown-body'><h1 id="h1-0">scons编译流程</h1><p>解决所有基础环境之后我们先来介绍一下 gem5 的编译过程, 即 scons 的编译流程</p><p><a href="https://github.com/SCons/scons" target="_blank">SCons</a>: a Software Construction Tool, 是一个开源的软件构建工具, 意在为 C/C++ 和 FORTRAN 内置的可靠/自动的依赖性分析.不再需要"make depend"或"make clean"来获取所有依赖项.通过用户定义的其他语言或文件类型的依赖扫描器,可以轻松扩展依赖分析</p><p>值得一提的是 SCons 是向下兼容 Python 语法的, 你可以查看根目录下的 SConstruct Sconsopts 这两个文件, 不难发现其语法和运行都是依赖python解释器工作的</p><p><a data-lightbox="example-1" href="https://raw.githubusercontent.com/learner-lu/picbed/master/20230331234936.png"><img src="https://raw.githubusercontent.com/learner-lu/picbed/master/20230331234936.png" alt="20230331234936"></a></p><p>当然你也可能会敏锐且惊讶的发现文件并没有全部高亮和提示, 仍有不少部分显示来自 Python 的报错信息. 这是因为这并不完全是 Python的语法, 也有一些来自 SCons 的内置命令(内置关键字) 并没有成功被 Python 解析. 目前并没有可用的 Vscode 扩展足以解决这个问题, 且这是一个<a href="https://github.com/SCons/scons/issues/3210" target="_blank">历史遗留的issue</a>, 且 SCons 团队也曾经试图向 Vscode 官方<a href="https://github.com/microsoft/vscode/issues/105623" target="_blank">反映过这个问题</a></p><p>当然你可以使用如下引入来引入部分智能提示, 但仍有部分 GlobalDefaultEnvironmentFunctions 之类指令存在语法报错</p><pre class="language-python"><code><span class="Token FROM">from</span><span class="Token SPACE"> </span><span class="ImportLibName Token ID">SCons</span><span class="Token DOT">.</span><span class="Token ID">Script</span><span class="Token SPACE"> </span><span class="Token IMPORT">import</span><span class="Token SPACE"> </span><span class="ImportLibName Token MUL">*</span></code></pre><p>除此之外你可能会发现找不到 gem5_scons 模块, 这需要你为 Pylance 扩展手动添加一个选项指明路径</p><p><a data-lightbox="example-1" href="https://raw.githubusercontent.com/learner-lu/picbed/master/20230401001534.png"><img src="https://raw.githubusercontent.com/learner-lu/picbed/master/20230401001534.png" alt="20230401001534"></a></p><p>Anyway, 我们至少可以开始阅读了</p><p>不过需要注意的是, 并不建议直接阅读 SConstruct 这种构建的源代码, 因为其中涉及很多细节和 SCons 自带的语法以及运行原理, 深入研究 SCons 并不是当务之急, 将其作为一个简单的工具使用即可, 我们只需要从宏观上去了解 gem5 系统是如何构建/运行的即可</p><h2 id="h2-1">gem5 目录结构</h2><p>基于gem5的研究大多需要更改源代码重新编译,因此确认系统环境没问题后,每一个项目内最好有各自对应的调整编译好的gem5,同时,官方教程给的代码与命令行有很多相对路径是固定的,因此最好保持和教程一致的文件结构,并且在相应位置编译gem5</p><p>我们先来看一下 gem5 的目录结构, 删除了部分无关文件/文件夹之后的根核心目录结构如下所示</p><pre class="language-shell"><code><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">build</span><span class="Token SPACE">         </span><span class="Token ID">构建得到的二进制文件</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">build_opts</span><span class="Token SPACE">    </span><span class="Token ID">构建可选参数</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">build_tools</span><span class="Token SPACE">   </span><span class="Token ID">构建时工具</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">configs</span><span class="Token SPACE">       </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token ID">一些模拟配置脚本</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">ext</span><span class="Token SPACE">           </span><span class="Token ID">构建所需的依赖库</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">include</span><span class="Token SPACE">       </span><span class="Token ID">一些可选宏</span><span class="Token QUSTION">?</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">m5out</span><span class="Token SPACE">         </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token ID">使用gem5模拟系统后的输出结果</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">SConsopts</span><span class="Token SPACE">     </span><span class="Token ID">SCons构建选项</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">SConstruct</span><span class="Token SPACE">    </span><span class="Token ID">SCons构建入口</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">site_scons</span><span class="Token SPACE">    </span><span class="Token ID">gem5修改的SCons构建依赖</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">src</span><span class="Token SPACE">           </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token ID">源代码主目录</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">system</span><span class="Token SPACE">        </span><span class="Token ID">模拟系统的固件或引导程序</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">tests</span><span class="Token SPACE">         </span><span class="Token ID">测试相关</span><span class="Token LF">
</span><span class="Token TEXT">└</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">util</span><span class="Token SPACE">          </span><span class="Token ID">实用脚本程序</span></code></pre><blockquote><p><a href="http://old.gem5.org/Source_Code.html" target="_blank">目录结构</a></p></blockquote><p>其中比较重要的部分已经使用 <code>[]</code> 括起来了, 分别是 <code>configs</code> <code>src</code> 这两部分是后续修改的核心位置, 我们会在后文分三部分详细描述如何</p><ul><li>在 <code>config</code> 中编写py脚本以完成相应任务</li></ul><ul><li>在 <code>src</code> 中修改源代码并构建自己的系统</li></ul><ul><li>分析 <code>m5out</code> 输出结果的具体内容, 这里保存着使用 gem5 模拟之后的所有结果</li></ul><hr><p>当我们使用 scons 构建的时候</p><pre class="language-shell"><code><span class="Token Program ID">scons</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/gem5.opt</span><span class="Token SPACE"> </span><span class="Token OPTION">-j4</span></code></pre><p>其中第一个参数 <code>build/X86/gem5.opt</code> 指明了三部分内容, 编译结果保存在 build/ 目录下, 编译可选的指令集及架构如下</p><pre class="language-shell"><code><span class="Token COMMENT"># build_opts/</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">ALL</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">ARM</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">ARM_MESI_Three_Level</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">ARM_MESI_Three_Level_HTM</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">ARM_MOESI_hammer</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">Garnet_standalone</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">GCN3_X86</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">MIPS</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">NULL</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">NULL_MESI_Two_Level</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">NULL_MOESI_CMP_directory</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">NULL_MOESI_CMP_token</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">NULL_MOESI_hammer</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">POWER</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">RISCV</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">SPARC</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">VEGA_X86</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">X86</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">X86_MESI_Two_Level</span><span class="Token LF">
</span><span class="Token TEXT">├</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">X86_MI_example</span><span class="Token LF">
</span><span class="Token TEXT">└</span><span class="Token TEXT">─</span><span class="Token TEXT">─</span><span class="Token SPACE"> </span><span class="Token Program ID">X86_MOESI_AMD_Base</span></code></pre><blockquote><p>我们可以在文件中看到一些key=value的参数, 比如 <code>PROTOCOL</code> 等</p></blockquote><p>最后一个参数决定以什么程度编译 gem5, 可选项如下</p><ul><li><code>gem5.debug</code> 关闭了优化.保证变量不会被优化掉,功能不会被意料外的内联(inlined),以及控制流行为正常.该版本与gdb类的工具合作良好,然而关闭优化会造成该版本明显慢于其它版本.当使用gdb或valgrind等工具并且不希望任何细节被模糊掉时应该选择该版本,否则建议选择其它版本.</li></ul><ul><li><code>gem5.opt</code> 打开优化的同时保留了部分调试功能(例如,断言和DPRINTFs).该版本良好地平衡了模拟速度与调试观察,是所有环境中最优的版本.</li></ul><ul><li><code>gem5.fast</code> 打开优化并关闭调试部分.最优的速度,代价是不能进行运行时错误检查与调试输出.如果确信所有功能可以正确运行并想要获得峰值性能,建议使用该版本.</li></ul><ul><li><code>gem5.prof</code> 类似于gem5.fast,但仍然保留了一些功能(instrumentation)可以用于gprof分析工具.该版本不常用,但可以用于找出gem5中应当被注意的部分以提升性能.</li></ul><ul><li><code>gem5.perf</code> 同gem5.prof,但是instrumentation使用google perftools,允许被google-pprof分析.该分析版本是gem5.prof的补充,可能可以在所有基于Linux的系统中替换gem5.prof.</li></ul><blockquote><p>简而言之, 编译选opt, 确定没问题了选fast</p></blockquote><p>与此同时 SConstruct 中也提供了一些 options 的选项, 不过这大多数都是控制输出等等, 并不是我们关心的问题</p><p>接着 scons 做了一些诸如版本/缓存/字节校验/python模块的工作, 之后根据 site_sons 中 gem5 特定的一些函数引入之类的工作, 确定没有问题了递归搜索所有目录, 找到其中子目录下的 SConstruct 做进一步的编译, 我们可以在 src 下的子文件夹中看到 一个一个的 SConstruct, 其中就包含了当前文件夹内部的编译依赖关系的. 总而言之经过 SCons 内部的依赖处理和检查, 开始编译了</p><p>随后将众多.o链接为 gem5.opt 可执行文件, 完成了整个系统的构建</p><h2 id="h2-2">具体的编译流程与细节</h2><p>细心的朋友可能会发现, 在 build/X86 下除了编译得到的 gem5.opt 文件还有 gem5py gem5py_m5 两个可执行文件, 我们找到 gem5py 对应的源码位置 src/python/gem5py.cc</p><pre class="language-cpp"><code>int main(int argc, const char **argv) {
    py::scoped_interpreter guard;
    // Embedded python doesn&#x27;t set up sys.argv, so we&#x27;ll do that ourselves.
    py::list py_argv;
    auto sys = py::module::import(&quot;sys&quot;);
    if (py::hasattr(sys, &quot;argv&quot;)) {
        // sys.argv already exists, so grab that.
        py_argv = sys.attr(&quot;argv&quot;);
    } else {
        // sys.argv doesn&#x27;t exist, so create it.
        sys.add_object(&quot;argv&quot;, py_argv);
    }
    // Clear out argv just in case it has something in it.
    py_argv.attr(&quot;clear&quot;)();
    if (argc &lt; 2) {
        std::cerr &lt;&lt; &quot;Usage: gem5py SCRIPT [arg] ...&quot; &lt;&lt; std::endl;
        std::exit(1);
    }
    // Fill it with our argvs.
    for (int i = 1; i &lt; argc; i++) py_argv.append(argv[i]);
    // Actually call the script.
    py::eval_file(argv[1]);
    return 0;
}</code></pre><p>大致浏览一下发现并不难理解, 就是简单的利用 pybind11 做了一个 python 解释器的封装, 调用此程序与直接调用 python 没什么太大区别, 我们可以创建一个简单的 python 文件做一次验证</p><pre class="language-python"><code><span class="Token IMPORT">import</span><span class="Token SPACE"> </span><span class="ImportLibName Token ID">sys</span><span class="Token LF">
</span><span class="Token FunctionCall ID">print</span><span class="BraceDepth-0 Token LPAREN">(</span><span class="Token ID">sys</span><span class="Token DOT">.</span><span class="Token ID">argv</span><span class="BraceDepth-0 Token RPAREN">)</span></code></pre><pre class="language-shell"><code><span class="Token HOST_NAME">kamilu@kamilu</span><span class="Token COLON">:</span><span class="Token DIR_PATH">~/gem5</span><span class="Token TAG"></span><span class="Token SPACE"> </span><span class="Token Program PATH">./build/X86/gem5py</span><span class="Token SPACE"> </span><span class="Token ID">a.py</span><span class="Token SPACE"> </span><span class="Token NUMBER">123</span><span class="Token SPACE"> </span><span class="Token NUMBER">456</span><span class="Token LF">
</span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token APOSTROPHE">&#x27;</span><span class="Token Program ID">a.py</span><span class="Token APOSTROPHE">&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token APOSTROPHE">&#x27;</span><span class="Token NUMBER">123</span><span class="Token APOSTROPHE">&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token APOSTROPHE">&#x27;</span><span class="Token NUMBER">456</span><span class="Token APOSTROPHE">&#x27;</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span></code></pre><p>我们可以在 scons 编译的一开头看到此文件的编译输出</p><pre class="language-shell"><code><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token SPACE">     </span><span class="Token Program ID">CXX</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE"> </span><span class="Token PATH">X86/python/gem5py.cc</span><span class="Token SPACE"> </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token ID">.pyo</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token SPACE">     </span><span class="Token Program ID">CXX</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE"> </span><span class="Token PATH">X86/python/embedded.cc</span><span class="Token SPACE"> </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token ID">.pyo</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token SPACE">     </span><span class="Token Program ID">CXX</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE"> </span><span class="Token PATH">X86/python/importer.cc</span><span class="Token SPACE"> </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token ID">.pyo</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token Program ID">VER</span><span class="Token SPACE"> </span><span class="Token ID">TAGS</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE">  </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token PATH">X86/sim/tags.cc</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token SPACE">     </span><span class="Token Program ID">CXX</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE"> </span><span class="Token PATH">X86/sim/init.cc</span><span class="Token SPACE"> </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token ID">.o</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token SPACE">     </span><span class="Token Program ID">CXX</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE"> </span><span class="Token PATH">X86/sim/main.cc</span><span class="Token SPACE"> </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token ID">.o</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token SPACE">     </span><span class="Token Program ID">CXX</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE"> </span><span class="Token PATH">X86/python/embedded.cc</span><span class="Token SPACE"> </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token ID">.o</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token SPACE">     </span><span class="Token Program ID">CXX</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE"> </span><span class="Token PATH">X86/python/importer.cc</span><span class="Token SPACE"> </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token ID">.o</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token SPACE">    </span><span class="Token Program ID">LINK</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE">  </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token PATH">X86/gem5py</span></code></pre><p>如果我们稍加修改 gem5py.cc 让其在编译时输出 argv 的相关信息, 可以看到具体的编译流程, 诸如此类大量的编译信息</p><pre class="language-shell"><code><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token SPACE"> </span><span class="Token Program ID">TRACING</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE">  </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token PATH">X86/debug/RubyDma.cc</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token SPACE"> </span><span class="Token Program ID">TRACING</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE">  </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token PATH">X86/debug/DistEthernet.cc</span><span class="Token LF">
</span><span class="Token Program PATH">build/X86/gem5py</span><span class="Token SPACE"> </span><span class="Token PATH">build_tools/debugflagcc.py</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/debug/DistEthernet.cc</span><span class="Token SPACE"> </span><span class="Token ID">DistEthernet</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token Program ID">EMBED</span><span class="Token SPACE"> </span><span class="Token ID">PY</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE"> </span><span class="Token PATH">X86/python/gem5/utils/multiprocessing/__init__.py</span><span class="Token SPACE"> </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token ID">.cc</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token Program ID">EMBED</span><span class="Token SPACE"> </span><span class="Token ID">PY</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE"> </span><span class="Token PATH">X86/dev/serial/Serial.py</span><span class="Token SPACE"> </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token ID">.cc</span><span class="Token LF">
</span><span class="Token Program PATH">build/X86/gem5py</span><span class="Token SPACE"> </span><span class="Token PATH">build_tools/debugflagcc.py</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/debug/RubyDma.cc</span><span class="Token SPACE"> </span><span class="Token ID">RubyDma</span><span class="Token LF">
</span><span class="Token Program PATH">build/X86/gem5py</span><span class="Token SPACE"> </span><span class="Token PATH">build_tools/marshal.py</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/python/gem5/utils/multiprocessing/__init__.py.cc</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/python/gem5/utils/multiprocessing/__init__.py</span><span class="Token SPACE"> </span><span class="Token ID">gem5.utils.multiprocessing</span><span class="Token SPACE"> </span><span class="Token PATH">/home/kamilu/gem5/src/python/gem5/utils/multiprocessing/__init__.py</span><span class="Token LF">
</span><span class="Token Program PATH">build/X86/gem5py</span><span class="Token SPACE"> </span><span class="Token PATH">build_tools/marshal.py</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/dev/serial/Serial.py.cc</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/dev/serial/Serial.py</span><span class="Token SPACE"> </span><span class="Token ID">m5.objects.Serial</span><span class="Token SPACE"> </span><span class="Token PATH">/home/kamilu/gem5/src/dev/serial/Serial.py</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token SPACE"> </span><span class="Token Program ID">TRACING</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE">  </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token PATH">X86/debug/Event.hh</span><span class="Token LF">
</span><span class="Token Program PATH">build/X86/gem5py</span><span class="Token SPACE"> </span><span class="Token PATH">build_tools/debugflaghh.py</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/debug/Event.hh</span><span class="Token SPACE"> </span><span class="Token ID">Event</span><span class="Token SPACE">  </span><span class="Token ID">False</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token SPACE"> </span><span class="Token Program ID">TRACING</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE">  </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token PATH">X86/debug/MC146818.cc</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token SPACE"> </span><span class="Token Program ID">TRACING</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE">  </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token PATH">X86/debug/Branch.hh</span><span class="Token LF">
</span><span class="Token Program PATH">build/X86/gem5py</span><span class="Token SPACE"> </span><span class="Token PATH">build_tools/debugflagcc.py</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/debug/MC146818.cc</span><span class="Token SPACE"> </span><span class="Token ID">MC146818</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token Program ID">EMBED</span><span class="Token SPACE"> </span><span class="Token ID">PY</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE"> </span><span class="Token PATH">X86/python/gem5/components/cachehierarchies/classic/caches/__init__.py</span><span class="Token SPACE"> </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token ID">.cc</span><span class="Token LF">
</span><span class="Token Program PATH">build/X86/gem5py</span><span class="Token SPACE"> </span><span class="Token PATH">build_tools/debugflaghh.py</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/debug/Branch.hh</span><span class="Token SPACE"> </span><span class="Token ID">Branch</span><span class="Token SPACE">  </span><span class="Token ID">False</span><span class="Token LF">
</span><span class="Token Program PATH">build/X86/gem5py</span><span class="Token SPACE"> </span><span class="Token PATH">build_tools/marshal.py</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/python/gem5/components/cachehierarchies/classic/caches/__init__.py.cc</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/python/gem5/components/cachehierarchies/classic/caches/__init__.py</span><span class="Token SPACE"> </span><span class="Token ID">gem5.components.cachehierarchies.classic.caches</span><span class="Token SPACE"> </span><span class="Token PATH">/home/kamilu/gem5/src/python/gem5/components/cachehierarchies/classic/caches/__init__.py</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token SPACE"> </span><span class="Token Program ID">TRACING</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE">  </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token PATH">X86/debug/CacheComp.hh</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token Program ID">EMBED</span><span class="Token SPACE"> </span><span class="Token ID">PY</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE"> </span><span class="Token PATH">X86/mem/MemCtrl.py</span><span class="Token SPACE"> </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token ID">.cc</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token SPACE"> </span><span class="Token Program ID">TRACING</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE">  </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token PATH">X86/debug/EthernetCksum.hh</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token SPACE"> </span><span class="Token Program ID">TRACING</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE">  </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token PATH">X86/debug/MemCtrl.cc</span><span class="Token LF">
</span><span class="Token Program PATH">build/X86/gem5py</span><span class="Token SPACE"> </span><span class="Token PATH">build_tools/debugflaghh.py</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/debug/CacheComp.hh</span><span class="Token SPACE"> </span><span class="Token ID">CacheComp</span><span class="Token SPACE">  </span><span class="Token ID">False</span><span class="Token LF">
</span><span class="Token Program PATH">build/X86/gem5py</span><span class="Token SPACE"> </span><span class="Token PATH">build_tools/marshal.py</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/mem/MemCtrl.py.cc</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/mem/MemCtrl.py</span><span class="Token SPACE"> </span><span class="Token ID">m5.objects.MemCtrl</span><span class="Token SPACE"> </span><span class="Token PATH">/home/kamilu/gem5/src/mem/MemCtrl.py</span><span class="Token LF">
</span><span class="Token Program PATH">build/X86/gem5py</span><span class="Token SPACE"> </span><span class="Token PATH">build_tools/debugflaghh.py</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/debug/EthernetCksum.hh</span><span class="Token SPACE"> </span><span class="Token ID">EthernetCksum</span><span class="Token SPACE">  </span><span class="Token ID">False</span><span class="Token LF">
</span><span class="Token Program PATH">build/X86/gem5py</span><span class="Token SPACE"> </span><span class="Token PATH">build_tools/debugflagcc.py</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/debug/MemCtrl.cc</span><span class="Token SPACE"> </span><span class="Token ID">MemCtrl</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token SPACE"> </span><span class="Token Program ID">TRACING</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE">  </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token PATH">X86/debug/MinorTiming.hh</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token SPACE"> </span><span class="Token Program ID">TRACING</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE">  </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token PATH">X86/debug/RubyProtocol.cc</span><span class="Token LF">
</span><span class="Token Program PATH">build/X86/gem5py</span><span class="Token SPACE"> </span><span class="Token PATH">build_tools/debugflaghh.py</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/debug/MinorTiming.hh</span><span class="Token SPACE"> </span><span class="Token ID">MinorTiming</span><span class="Token SPACE"> </span><span class="Token ID">Extra</span><span class="Token SPACE"> </span><span class="Token ID">timing</span><span class="Token SPACE"> </span><span class="Token Keyword FOR">for</span><span class="Token SPACE"> </span><span class="Token ID">instructions</span><span class="Token SPACE"> </span><span class="Token ID">False</span><span class="Token LF">
</span><span class="Token Program PATH">build/X86/gem5py</span><span class="Token SPACE"> </span><span class="Token PATH">build_tools/debugflagcc.py</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/debug/RubyProtocol.cc</span><span class="Token SPACE"> </span><span class="Token ID">RubyProtocol</span><span class="Token LF">
</span><span class="Token Program ID">......</span></code></pre><p>接着过了一段时间又出现了 <code>gem5py_m5</code>, 然后就是关于 gem5py_m5 的构建</p><pre class="language-shell"><code><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token SPACE"> </span><span class="Token Program ID">TRACING</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE">  </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token PATH">X86/debug/TimeSync.hh</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token SPACE"> </span><span class="Token Program ID">TRACING</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE">  </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token PATH">X86/debug/Fetch.hh</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token SPACE"> </span><span class="Token Program ID">TRACING</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE">  </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token PATH">X86/debug/KvmIO.cc</span><span class="Token LF">
</span><span class="Token Program PATH">build/X86/gem5py</span><span class="Token SPACE"> </span><span class="Token PATH">build_tools/debugflaghh.py</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/debug/TimeSync.hh</span><span class="Token SPACE"> </span><span class="Token ID">TimeSync</span><span class="Token SPACE">  </span><span class="Token ID">False</span><span class="Token LF">
</span><span class="Token Program PATH">build/X86/gem5py</span><span class="Token SPACE"> </span><span class="Token PATH">build_tools/debugflaghh.py</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/debug/Fetch.hh</span><span class="Token SPACE"> </span><span class="Token ID">Fetch</span><span class="Token SPACE">  </span><span class="Token ID">False</span><span class="Token LF">
</span><span class="Token Program PATH">build/X86/gem5py</span><span class="Token SPACE"> </span><span class="Token PATH">build_tools/debugflagcc.py</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/debug/KvmIO.cc</span><span class="Token SPACE"> </span><span class="Token ID">KvmIO</span><span class="Token LF">
</span><span class="Token Program PATH">build/X86/gem5py</span><span class="Token SPACE"> </span><span class="Token PATH">build_tools/marshal.py</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/python/gem5/utils/multiprocessing/_command_line.py.cc</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/python/gem5/utils/multiprocessing/_command_line.py</span><span class="Token SPACE"> </span><span class="Token ID">gem5.utils.multiprocessing._command_line</span><span class="Token SPACE"> </span><span class="Token PATH">/home/kamilu/gem5/src/python/gem5/utils/multiprocessing/_command_line.py</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token SPACE">    </span><span class="Token Program ID">LINK</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE">  </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token PATH">X86/gem5py_m5</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="Token Program ID">...</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token Program ID">SO</span><span class="Token SPACE"> </span><span class="Token ID">Param</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE"> </span><span class="Token ID">m5.objects.ThermalModel</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token ID">ThermalReference</span><span class="Token SPACE"> </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token PATH">X86/python/_m5/param_ThermalReference.cc</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token Program ID">SO</span><span class="Token SPACE"> </span><span class="Token ID">Param</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE"> </span><span class="Token ID">m5.objects.BaseMinorCPU</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token ID">MinorFUPool</span><span class="Token SPACE"> </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token PATH">X86/params/MinorFUPool.hh</span><span class="Token LF">
</span><span class="Token Program PATH">build/X86/gem5py_m5</span><span class="Token SPACE"> </span><span class="Token PATH">build_tools/sim_object_param_struct_cc.py</span><span class="Token SPACE"> </span><span class="Token ID">m5.objects.ThermalModel</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/python/_m5/param_ThermalReference.cc</span><span class="Token SPACE"> </span><span class="Token ID">True</span><span class="Token LF">
</span><span class="Token Program PATH">build/X86/gem5py_m5</span><span class="Token SPACE"> </span><span class="Token PATH">build_tools/sim_object_param_struct_hh.py</span><span class="Token SPACE"> </span><span class="Token ID">m5.objects.BaseMinorCPU</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/params/MinorFUPool.hh</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token Program ID">SO</span><span class="Token SPACE"> </span><span class="Token ID">Param</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE"> </span><span class="Token ID">m5.objects.SMBios</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token ID">X86SMBiosSMBiosTable</span><span class="Token SPACE"> </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token PATH">X86/params/X86SMBiosSMBiosTable.hh</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token Program ID">SO</span><span class="Token SPACE"> </span><span class="Token ID">Param</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE"> </span><span class="Token ID">m5.objects.Uart</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token ID">Uart8250</span><span class="Token SPACE"> </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token PATH">X86/params/Uart8250.hh</span><span class="Token LF">
</span><span class="Token Program PATH">build/X86/gem5py_m5</span><span class="Token SPACE"> </span><span class="Token PATH">build_tools/sim_object_param_struct_hh.py</span><span class="Token SPACE"> </span><span class="Token ID">m5.objects.Uart</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/params/Uart8250.hh</span><span class="Token LF">
</span><span class="Token Program PATH">build/X86/gem5py_m5</span><span class="Token SPACE"> </span><span class="Token PATH">build_tools/sim_object_param_struct_hh.py</span><span class="Token SPACE"> </span><span class="Token ID">m5.objects.SMBios</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/params/X86SMBiosSMBiosTable.hh</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token Program ID">SO</span><span class="Token SPACE"> </span><span class="Token ID">Param</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE"> </span><span class="Token ID">m5.objects.X86SeWorkload</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token ID">X86EmuLinux</span><span class="Token SPACE"> </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token PATH">X86/python/_m5/param_X86EmuLinux.cc</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token Program ID">SO</span><span class="Token SPACE"> </span><span class="Token ID">Param</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE"> </span><span class="Token ID">m5.objects.Tags</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token ID">CompressedTags</span><span class="Token SPACE"> </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token PATH">X86/python/_m5/param_CompressedTags.cc</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token LSQUAR_PAREN">[</span><span class="Token Program ID">SO</span><span class="Token SPACE"> </span><span class="Token ID">Param</span><span class="BraceDepth-0 Token RSQUAR_PAREN">]</span><span class="Token SPACE"> </span><span class="Token ID">m5.objects.TlmBridge</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token ID">TlmToGem5BridgeBase</span><span class="Token SPACE"> </span><span class="Token MINUS">-</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token SPACE"> </span><span class="Token PATH">X86/python/_m5/param_TlmToGem5BridgeBase.cc</span><span class="Token LF">
</span><span class="Token Program PATH">build/X86/gem5py_m5</span><span class="Token SPACE"> </span><span class="Token PATH">build_tools/sim_object_param_struct_cc.py</span><span class="Token SPACE"> </span><span class="Token ID">m5.objects.X86SeWorkload</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/python/_m5/param_X86EmuLinux.cc</span><span class="Token SPACE"> </span><span class="Token ID">True</span><span class="Token LF">
</span><span class="Token Program PATH">build/X86/gem5py_m5</span><span class="Token SPACE"> </span><span class="Token PATH">build_tools/sim_object_param_struct_cc.py</span><span class="Token SPACE"> </span><span class="Token ID">m5.objects.Tags</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/python/_m5/param_CompressedTags.cc</span><span class="Token SPACE"> </span><span class="Token ID">True</span><span class="Token LF">
</span><span class="Token Program PATH">build/X86/gem5py_m5</span><span class="Token SPACE"> </span><span class="Token PATH">build_tools/sim_object_param_struct_cc.py</span><span class="Token SPACE"> </span><span class="Token ID">m5.objects.TlmBridge</span><span class="Token SPACE"> </span><span class="Token PATH">build/X86/python/_m5/param_TlmToGem5BridgeBase.cc</span><span class="Token SPACE"> </span><span class="Token ID">True</span></code></pre><p>到此为止不难得出两个结论, 1. <code>gem5py</code> <code>gem5py_m5</code> 在 py cpp 文件直接做了很多相关的文件转换工作, 2. <code>build_tools</code> 这个目录似乎很重要</p><blockquote><p>关于 build_tools 这个目录里的代码, 我的评价是<b>可读性极差, 极其不优雅, 着实有些难绷...</b></p></blockquote><h2 id="h2-3">结语</h2><p>正如笔者开头所说: &quot;并不建议直接阅读 SConstruct 这种构建的源代码, 因为其中涉及很多细节和 SCons 自带的语法以及运行原理, 深入研究 SCons 并不是当务之急, 将其作为一个简单的工具使用即可, 我们只需要从宏观上去了解 gem5 系统是如何构建/运行的即可&quot;, 本文也只是简单的介绍了一下 gem5 的根目录结构以及相关选项的含义, 没有深入 SCons 的部分.</p><p>我们会在后文对于源代码的修改/添加的时候引入对于 SConstruct 文件的修改, 结合修改实例去做一个更为贴近现实的讲解, 相比于大而泛的空谈 SCons 构建过程, 不如照猫画虎照葫芦画瓢来的更直观</p></div>
    <div class="dir-tree"><ul><li><a href="../../md-docs/README" >README</a></li></ul><ul><li><a href="../../gem5的编译和使用/gem5简介" >gem5的编译和使用</a><ul><li><a href="../../gem5的编译和使用/gem5简介" >gem5简介</a></li></ul><ul><li><a href="../../gem5的编译和使用/安装与构建" >安装与构建</a></li></ul><ul><li><a href="../../gem5的编译和使用/第一个程序" >第一个程序</a></li></ul><ul><li><a href="../../gem5的编译和使用/全系统模拟" >全系统模拟</a></li></ul><ul><li><a href="../../gem5的编译和使用/linux-kernel构建" >linux-kernel构建</a></li></ul><ul><li><a href="../../gem5的编译和使用/性能测试与统计结果" >性能测试与统计结果</a></li></ul></li></ul><ul><li><a href="../../pybind11/环境配置" >pybind11</a><ul><li><a href="../../pybind11/环境配置" >环境配置</a></li></ul><ul><li><a href="../../pybind11/基础语法" >基础语法</a></li></ul><ul><li><a href="../../pybind11/面向对象" >面向对象</a></li></ul></li></ul><ul><li><a href="../../gem5源码分析/环境配置" >gem5源码分析</a><ul><li><a href="../../gem5源码分析/环境配置" >环境配置</a></li></ul><ul><li><a href="../../gem5源码分析/scons编译流程" >scons编译流程</a></li></ul><ul><li><a href="../../gem5源码分析/gem5启动流程" >gem5启动流程</a></li></ul><ul><li><a href="../../gem5源码分析/SimObject" >SimObject</a></li></ul></li></ul></div>
    <div class="zood"><a class="" href="https://github.com/luzhixing12345/zood" target="_blank">zood</a></div>
    <script type="text/javascript" src="../../../js/next_front.js"></script><script>addLink("../../gem5源码分析/环境配置","../../gem5源码分析/gem5启动流程","ab")</script><script type="text/javascript" src="../../../js/change_mode.js"></script><script>addChangeModeButton("../../../img/sun.png","../../../img/moon.png")</script><script type="text/javascript" src="../../../js/copy_code.js"></script><script>addCodeCopy("../../../img/before_copy.png","../../../img/after_copy.png")</script><script type="text/javascript" src="../../../js/navigator.js"></script><script type="text/javascript" src="../../../js/picture_preview.js"></script><script type="text/javascript" src="../../../js/global_js_configuration.js"></script>
</body>

</html>